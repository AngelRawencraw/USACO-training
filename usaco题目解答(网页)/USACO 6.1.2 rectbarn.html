<html>
<head>
  <title>USACO 6.1.2 rectbarn</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/268868 (zh-CN); Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1991"/>
<h1>USACO 6.1.2 rectbarn</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div align="left" style="text-indent: 0mm; text-align: -webkit-left; margin: 4.75mm 0mm;"><font face="黑体"><font color="#010101"><span style="font-size: 13pt;"><b>[</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>解题报告</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>]</b></span></font></font></div><div align="left" style="text-indent: 0mm; text-align: -webkit-left; margin: 4.75mm 0mm;"><div align="left" style="text-align: start; text-indent: 0mm; margin: 4.75mm 0mm;"><font color="#010101" face="宋体" size="4">这道题目乍一看很类似5.3.4但是因为这道题目是矩形而不是正方形，所以要考虑到转移方程会出现多种不同的状况。但是鉴于数据规模我们还是要使用DP，主要思想是极大化思想，如果一个子矩阵向左向右都不能扩展，那么这个子矩阵就是极大子矩阵。显然我们要找到的答案肯定是一个极大子矩阵。</font></div><div align="left" style="text-align: start; text-indent: 0mm; margin: 4.75mm 0mm;"><font color="#010101" face="宋体" size="4">设H[i][j]表示点(i,j)所能向上伸展的最大高度，那么有H[i][j] = H[i-1][j] + 1(点i，j不是障碍)</font></div><div align="left" style="text-align: start; text-indent: 0mm; margin: 4.75mm 0mm;"><font color="#010101" face="宋体" size="4">left[i][j]表示点i,j向上长度为H[i][j]的线段向左能扩展的最长距离，同理</font><span style="color: rgb(1, 1, 1); font-family: 宋体; font-size: large; text-indent: 0mm;">right[i][j]表示点i,j向上长度为H[i][j]的线段向右能扩展的最长距离，left[i][j] = min(left[i-1][j], maxleftlen)，maxleftlen是点(i,j)向左伸展的最长距离。right的转移方程同理。也就是这道题目与5.3.4不同之处之一是要考虑向右扩展，这是因为left是基于H的，如果只考虑向左的话我们的结果只能保证矩阵尽量的高，他横向的宽度不能保证，这个时候同时向右扩展也就是解决了宽度的问题。毕竟矩阵左右两边都应该是一个极大的界。</span></div></div><div align="left" style="text-indent: 0mm; text-align: -webkit-left; margin: 4.75mm 0mm;"><font face="黑体"><font color="#010101"><span style="font-size: 13pt;"><b>[</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>运行情况</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>]<br></b></span></font></font></div><div align="left" style="text-indent: 0mm; text-align: -webkit-left; margin: 4.75mm 0mm;"><pre style="text-align: start;">
Compiling...
Compile: OK

Executing...
   Test 1: TEST OK [0.000 secs, 12224 KB]
   Test 2: TEST OK [0.000 secs, 12224 KB]
   Test 3: TEST OK [0.000 secs, 12224 KB]
   Test 4: TEST OK [0.000 secs, 12224 KB]
   Test 5: TEST OK [0.000 secs, 12224 KB]
   Test 6: TEST OK [0.011 secs, 12224 KB]
   Test 7: TEST OK [0.011 secs, 12224 KB]
   Test 8: TEST OK [0.065 secs, 12224 KB]
   Test 9: TEST OK [0.097 secs, 12224 KB]
   Test 10: TEST OK [0.097 secs, 12224 KB]

All tests OK.
<br>Your program ('rectbarn') produced all correct answers!  This is your
submission #2 for this problem.  <b>Congratulations!</b></pre></div><div align="left" style="text-indent: 0mm; text-align: -webkit-left; margin: 4.75mm 0mm;"><pre style="text-align: start;"></pre></div><div align="left" style="text-indent: 0mm; text-align: -webkit-left; margin: 4.75mm 0mm;"><pre style="text-align: start;"></pre></div><div align="left" style="text-indent: 0mm; text-align: -webkit-left; margin: 4.75mm 0mm;"><pre style="text-align: start;"></pre><pre style="text-align: start;"></pre></div><div align="left" style="text-indent: 0mm; text-align: -webkit-left; margin: 4.75mm 0mm;"><font face="黑体"><font color="#010101"><span style="font-size: 13pt;"><b>[</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>程序清单</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>]</b></span></font></font></div><div align="left" style="text-indent: 0mm; text-align: -webkit-left; margin: 4.75mm 0mm;"><div align="left"><pre style="line-height: 12pt; font-size: 13px; background-color: rgb(255, 255, 236);"></pre><div dir="ltr" lang="zh-cn" style="direction: ltr; text-align: start;"><div dir="ltr" style="text-align: left;"><pre style="line-height: 12pt;"></pre><div><pre style="font-size: 13px; line-height: 12pt; background-color: rgb(255, 255, 236);"></pre><pre style="line-height: 12pt;"></pre><pre style="background-color: rgb(255, 255, 236);"></pre><pre style="line-height: 12pt; font-size: 13px;"></pre><pre style="line-height: 12pt; background-color: rgb(255, 255, 236);"></pre><pre style="line-height: 12pt; font-size: 13px;"></pre><pre style="line-height: 12pt; background-color: rgb(255, 255, 236);"><span style="color: rgb(51, 153, 0);">#include &lt;iostream&gt;
</span><span style="color: rgb(51, 153, 0);">#include &lt;cstring&gt;
</span><span style="color: rgb(51, 153, 0);">#include &lt;cstdio&gt;</span>
 
<span style="color: rgb(51, 153, 0);">#define MIN(a, b) (a &lt; b ? (a ? a : b) : b)
</span><span style="color: rgb(51, 153, 0);">#define MAX(a, b) (a &gt; b ? a : b)
</span><span style="color: rgb(51, 153, 0);">#define MAXN 3000 + 5</span>
 
<span style="color: rgb(0, 0, 255);">using</span> <span style="color: rgb(0, 0, 255);">namespace</span> std<span style="color: rgb(0, 128, 128);">;</span>
 
<span style="color: rgb(0, 0, 255);">bool</span> map<span style="color: rgb(0, 128, 0);">[</span>MAXN<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">[</span>MAXN<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;
</span><span style="color: rgb(0, 0, 255);">int</span> lr<span style="color: rgb(0, 128, 0);">[</span>MAXN<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">[</span><span style="color: rgb(0, 0, 221);">2</span><span style="color: rgb(0, 128, 0);">]</span>, h<span style="color: rgb(0, 128, 0);">[</span>MAXN<span style="color: rgb(0, 128, 0);">]</span>, r, c, p, x, y, ans<span style="color: rgb(0, 128, 128);">;</span><span style="color: rgb(102, 102, 102);">//滚动数组</span>
 
<span style="color: rgb(0, 0, 255);">int</span> main<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
        <span style="color: rgb(0, 0, 221);">freopen</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(255, 0, 0);">&quot;rectbarn.in&quot;</span>, <span style="color: rgb(255, 0, 0);">&quot;r&quot;</span>, <span style="color: rgb(0, 0, 255);">stdin</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 221);">freopen</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(255, 0, 0);">&quot;rectbarn.out&quot;</span>, <span style="color: rgb(255, 0, 0);">&quot;w&quot;</span>, <span style="color: rgb(0, 0, 255);">stdout</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 221);">cin</span> <span style="color: rgb(0, 0, 128);">&gt;&gt;</span> r <span style="color: rgb(0, 0, 128);">&gt;&gt;</span> c <span style="color: rgb(0, 0, 128);">&gt;&gt;</span> p<span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">int</span> i <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 128);">;</span> i <span style="color: rgb(0, 0, 128);">&lt;=</span> p <span style="color: rgb(0, 128, 128);">;</span> i<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                <span style="color: rgb(0, 0, 221);">scanf</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(255, 0, 0);">&quot;%d%d&quot;</span>, <span style="color: rgb(0, 0, 64);">&amp;</span>x, <span style="color: rgb(0, 0, 64);">&amp;</span>y<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                map<span style="color: rgb(0, 128, 0);">[</span>x<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">[</span>y<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 128, 0);">}</span>
        <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">int</span> i <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 128);">;</span> i <span style="color: rgb(0, 0, 128);">&lt;=</span> r<span style="color: rgb(0, 128, 128);">;</span> i<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                p <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 128);">;</span> <span style="color: rgb(102, 102, 102);">//统计横向可以扩展的长度</span>
                <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">int</span> j <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 128);">;</span> j <span style="color: rgb(0, 0, 128);">&lt;=</span> c<span style="color: rgb(0, 128, 128);">;</span> j<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span>
                        <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 64);">!</span>map<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">[</span>j<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                                h<span style="color: rgb(0, 128, 0);">[</span>j<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> h<span style="color: rgb(0, 128, 0);">[</span>j<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 64);">+</span> <span style="color: rgb(0, 0, 221);">1</span>, <span style="color: rgb(0, 0, 64);">++</span>p<span style="color: rgb(0, 128, 128);">;</span>
                                lr<span style="color: rgb(0, 128, 0);">[</span>j<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">[</span><span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> MIN<span style="color: rgb(0, 128, 0);">(</span>lr<span style="color: rgb(0, 128, 0);">[</span>j<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">[</span><span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 0);">]</span>, p<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                        <span style="color: rgb(0, 128, 0);">}</span><span style="color: rgb(0, 0, 255);">else</span>
                                h<span style="color: rgb(0, 128, 0);">[</span>j<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">0</span>, lr<span style="color: rgb(0, 128, 0);">[</span>j<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">[</span><span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">0</span>, p <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 128);">;</span>
                p <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 128);">;</span>
                <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">int</span> j <span style="color: rgb(0, 0, 128);">=</span> c<span style="color: rgb(0, 128, 128);">;</span> j <span style="color: rgb(0, 0, 128);">&gt;=</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 128);">;</span> j<span style="color: rgb(0, 0, 64);">--</span><span style="color: rgb(0, 128, 0);">)</span>
                        <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 64);">!</span>map<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">[</span>j<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                                <span style="color: rgb(0, 0, 64);">++</span>p, lr<span style="color: rgb(0, 128, 0);">[</span>j<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">[</span><span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> MIN<span style="color: rgb(0, 128, 0);">(</span>lr<span style="color: rgb(0, 128, 0);">[</span>j<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">[</span><span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 0);">]</span>, p<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                                ans <span style="color: rgb(0, 0, 128);">=</span> MAX<span style="color: rgb(0, 128, 0);">(</span>ans, h<span style="color: rgb(0, 128, 0);">[</span>j<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 64);">*</span> <span style="color: rgb(0, 128, 0);">(</span>lr<span style="color: rgb(0, 128, 0);">[</span>j<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">[</span><span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 64);">+</span> lr<span style="color: rgb(0, 128, 0);">[</span>j<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">[</span><span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 64);">-</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                        <span style="color: rgb(0, 128, 0);">}</span><span style="color: rgb(0, 0, 255);">else</span>
                                lr<span style="color: rgb(0, 128, 0);">[</span>j<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">[</span><span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">0</span>, p <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 128, 0);">}</span>
        <span style="color: rgb(0, 0, 221);">cout</span> <span style="color: rgb(0, 0, 128);">&lt;&lt;</span> ans <span style="color: rgb(0, 0, 128);">&lt;&lt;</span> endl<span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 255);">return</span> <span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 128);">;
</span><span style="color: rgb(0, 128, 0);">}</span></pre></div></div></div></div></div><div align="left" style="text-indent: 0mm; text-align: -webkit-left; margin: 4.75mm 0mm;"><font face="黑体"><font color="#010101"><span style="font-size: 13pt;"><b>[</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>注意事项</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>]</b></span></font></font></div><div align="left" style="text-indent: 0mm; text-align: -webkit-left; margin: 4.75mm 0mm;"><font color="#010101" face="宋体">如果(i,j)是障碍物，不要让以后left转移后结果是0.</font></div><div align="justify"><font face="黑体"><font color="#010101"><span style="font-size: 13pt;"><b>[</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>难易等级</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>]</b></span></font></font><font color="#010101" size="2"><span style="font-size: 10pt;"><b><font face="黑体"> Medium Down(noip the 3rd)</font></b></span></font></div></div>
</div></body></html> 