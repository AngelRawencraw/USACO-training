<html>
<head>
  <title>USACO 4.3.4 lgame</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/268868 (zh-CN); Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="810"/>
<h1>USACO 4.3.4 lgame</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>解题报告</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体"><span style="font-size:12pt">这好像是第二道带字典的题目了。方法是</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">:</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">枚举</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">+</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">位运算优化。最多只有</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">7</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">个字母，那么就用一个</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">long</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">类型记录用过的字母，所以对于没有用过的字母的判断方式是：两个单词的记录的按位与等于</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">0</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">。当然这样判断还有漏洞，这要查找时记录两种位置就行了：</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">1.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">正序扫描的，</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">2.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">反序扫描的。（想想为什么，不做过多解释）。这样用</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">O(C*N)</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">的复杂度构造完成所有单个字串，然后查找一对的字串再次单调扫描即可。最后需要排序。</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体"><span style="font-size:12pt">喜欢</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">USACO</span></font> <font color="#010101" face="宋体"><span style="font-size:12pt">的分析：</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">Note that although that are many words, there are not very many letters. We are given no more then 7 letters, and we use at least 3 of them on the first word. There are 4! four letter words and 4*3! three letter words that can be formed with the remaining letters, for a total of only 48 possibilities for the second word. Thus, for each word that can be made with the given letters, we can determine all strings that can be formed with the remaining letters, and look them up in the dictionary to see if they are words. As there can be at most 48 possibilities for the second word, once the first word has been chosen, this algorithm requires no more then 40,000 * 48 = 1,920,000 lookups.</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:12pt">How quickly can we lookup a word? If we store the dictionary in a trie, the cost of looking up a word is equal to the word's length, which is in this case, at most 7. Thus, this algorithm requires at most 40,000 * 48 * 7 = 13,440,000 operations, which is quite reasonable. We could also use a binary search to lookup words.</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>运行情况</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">Compiling... //</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">看样子我的程序的常数不小</span></font> <font color="#010101" face="Arial" size="2"><span style="font-size:10pt"><br>
Compile: OK</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">Executing...<br>
   Test 1: TEST OK [0.043 secs, 4764 KB]<br>
   Test 2: TEST OK [0.054 secs, 4632 KB]<br>
   Test 3: TEST OK [0.054 secs, 4896 KB]<br>
   Test 4: TEST OK [0.065 secs, 4632 KB]<br>
   Test 5: TEST OK [0.022 secs, 4632 KB]<br>
   Test 6: TEST OK [0.065 secs, 4632 KB]<br>
   Test 7: TEST OK [0.054 secs, 4632 KB]<br>
   Test 8: TEST OK [0.065 secs, 4632 KB]<br>
   Test 9: TEST OK [0.043 secs, 5292 KB]<br>
   Test 10: TEST OK [0.065 secs, 4896 KB]<br>
   Test 11: TEST OK [0.065 secs, 4632 KB]<br>
   Test 12: TEST OK [0.032 secs, 4632 KB]</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">All tests OK.<br></span><span style="font-size:10pt"><b>YOUR PROGRAM ('lgame') WORKED FIRST TIME!</b></span><span style="font-size:10pt"> That's fantastic<br>
-- and a rare thing. Please accept these special automated<br>
congratulations.</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>程序清单</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><div align="left"><font color="#0000FF" face="Times New Roman">#include</font><font color="#A31515" face="Times New Roman">&lt;fstream&gt;</font></div><div align="left"><font color="#0000FF" face="Times New Roman">#include</font><font color="#A31515" face="Times New Roman">&lt;cstring&gt;</font></div><div align="left"><font color="#0000FF" face="Times New Roman">#include</font><font color="#A31515" face="Times New Roman">&lt;cstdlib&gt;</font></div><div align="left"><font color="#0000FF" face="Times New Roman">#include</font><font color="#A31515" face="Times New Roman">&lt;string.h&gt;</font></div><div align="left"><font color="#0000FF" face="Times New Roman">#define</font> <font face="Times New Roman">MAX(a,b) ((a)&gt;(b)?(a):(b))</font></div><div align="left"><font color="#0000FF" face="Times New Roman">#define</font> <font face="Times New Roman">BIG 40005</font></div><div align="left"><font color="#0000FF" face="Times New Roman">using</font> <font color="#0000FF" face="Times New Roman">namespace</font> <font face="Times New Roman">std;</font></div><div align="left"><font face="Times New Roman">ofstream fout (</font><font color="#A31515" face="Times New Roman">&quot;lgame.out&quot;</font><font face="Times New Roman">,ios::out);</font></div><div align="left"><font face="Times New Roman">ifstream fin (</font><font color="#A31515" face="Times New Roman">&quot;lgame.in&quot;</font><font face="Times New Roman">,ios::in);</font></div><div align="left"><font face="Times New Roman">ifstream fdt (</font><font color="#A31515" face="Times New Roman">&quot;lgame.dict&quot;</font><font face="Times New Roman">,ios::in);</font></div><div align="left"><font face="Times New Roman">string dict[BIG],module,ans[BIG];</font></div><div align="left"><font color="#0000FF" face="Times New Roman">long</font> <font face="Times New Roman">lend,pos[BIG][3],maxn,lena</font></div><div align="left"><font face="Times New Roman">    ,score[]={2,5,4,4,1,6,5,5,1,7,6,3,5,2,3,5,7,2,1,2,4,6,6,7,5,7};</font></div><div align="left"><font color="#0000FF" face="Times New Roman">bool</font> <font face="Times New Roman">rec[9][2],flag;</font></div><div align="left"><font color="#0000FF" face="Times New Roman">int</font> <font face="Times New Roman">cmp(</font><font color="#0000FF" face="Times New Roman">const</font> <font color="#0000FF" face="Times New Roman">void</font> <font face="Times New Roman">*a,</font> <font color="#0000FF" face="Times New Roman">const</font> <font color="#0000FF" face="Times New Roman">void</font> <font face="Times New Roman">*b){</font></div><div align="left"><font face="Times New Roman">    string A=*(string*)a,B=*(string*)b;</font></div><div align="left"><font face="Times New Roman">   </font> <font color="#0000FF" face="Times New Roman">if</font><font face="Times New Roman">(A&gt;B)</font> <font color="#0000FF" face="Times New Roman">return</font> <font face="Times New Roman">1;</font><font color="#0000FF" face="Times New Roman">else</font> <font color="#0000FF" face="Times New Roman">return</font> <font face="Times New Roman">-1;</font></div><div align="left"><font face="Times New Roman">}</font></div><div align="left"><font color="#0000FF" face="Times New Roman">int</font> <font face="Times New Roman">main()</font></div><div align="left"><font face="Times New Roman">{</font></div><div align="left"><font face="Times New Roman">   </font> <font color="#0000FF" face="Times New Roman">while</font><font face="Times New Roman">(fdt&gt;&gt;dict[++lend])</font> <font color="#0000FF" face="Times New Roman">if</font><font face="Times New Roman">(dict[lend][0]==</font><font color="#A31515" face="Times New Roman">'.'</font> <font face="Times New Roman">)</font> <font color="#0000FF" face="Times New Roman">break</font><font face="Times New Roman">;</font></div><div align="left"><font face="Times New Roman">                lend--;</font></div><div align="left"><font face="Times New Roman">    fin&gt;&gt;module;</font></div><div align="left"><font face="Times New Roman">       </font> <font color="#0000FF" face="Times New Roman">for</font><font face="Times New Roman">(</font><font color="#0000FF" face="Times New Roman">int</font> <font face="Times New Roman">i=1;i&lt;=lend;i++){</font></div><div align="left"><font face="Times New Roman">        memset(rec,0,</font> <font color="#0000FF" face="Times New Roman">sizeof</font><font face="Times New Roman">(rec));</font></div><div align="left"><font face="Times New Roman">       </font> <font color="#0000FF" face="Times New Roman">for</font><font face="Times New Roman">(</font><font color="#0000FF" face="Times New Roman">int</font> <font face="Times New Roman">j=0;j&lt;dict[i].length();j++){</font></div><div align="left"><font face="Times New Roman">            flag=</font> <font color="#0000FF" face="Times New Roman">false</font><font face="Times New Roman">;</font></div><div align="left"><font face="Times New Roman">           </font> <font color="#0000FF" face="Times New Roman">for</font><font face="Times New Roman">(</font><font color="#0000FF" face="Times New Roman">int</font> <font face="Times New Roman">k=0;k&lt;module.length();k++)</font></div><div align="left"><font face="Times New Roman">               </font> <font color="#0000FF" face="Times New Roman">if</font><font face="Times New Roman">(!rec[k][0] &amp;&amp; module[k]==dict[i][j]){</font></div><div align="left"><font face="Times New Roman">                    pos[i][0]|=(1&lt;&lt;k);</font></div><div align="left"><font face="Times New Roman">                    pos[i][1]+=score[module[k]-97];</font></div><div align="left"><font face="Times New Roman">                    flag=</font> <font color="#0000FF" face="Times New Roman">true</font><font face="Times New Roman">;</font></div><div align="left"><font face="Times New Roman">                    rec[k][0]=</font> <font color="#0000FF" face="Times New Roman">true</font><font face="Times New Roman">;</font></div><div align="left"><font face="Times New Roman">                   </font> <font color="#0000FF" face="Times New Roman">break</font><font face="Times New Roman">;</font></div><div align="left"><font face="Times New Roman">                }</font></div><div align="left"><font face="Times New Roman">           </font> <font color="#0000FF" face="Times New Roman">if</font><font face="Times New Roman">(flag)</font> <font color="#0000FF" face="Times New Roman">for</font> <font face="Times New Roman">(</font><font color="#0000FF" face="Times New Roman">int</font> <font face="Times New Roman">k=module.length()-1;k&gt;=0;k--)</font></div><div align="left"><font face="Times New Roman">                       </font> <font color="#0000FF" face="Times New Roman">if</font><font face="Times New Roman">(!rec[k][1] &amp;&amp; module[k]==dict[i][j]){</font></div><div align="left"><font face="Times New Roman">                        pos[i][2]|=(1&lt;&lt;k);</font></div><div align="left"><font face="Times New Roman">                        rec[k][1]=</font> <font color="#0000FF" face="Times New Roman">true</font><font face="Times New Roman">;</font></div><div align="left"><font face="Times New Roman">                       </font> <font color="#0000FF" face="Times New Roman">break</font><font face="Times New Roman">;</font></div><div align="left"><font face="Times New Roman">                    }</font></div><div align="left"><font face="Times New Roman">           </font> <font color="#0000FF" face="Times New Roman">if</font><font face="Times New Roman">(!flag) {pos[i][1]=0;</font><font color="#0000FF" face="Times New Roman">break</font> <font face="Times New Roman">;}</font></div><div align="left"><font face="Times New Roman">        }</font></div><div align="left"><font face="Times New Roman">       </font> <font color="#0000FF" face="Times New Roman">if</font><font face="Times New Roman">(pos[i][1]==maxn) ans[++lena]=dict[i];</font></div><div align="left"><font face="Times New Roman">       </font> <font color="#0000FF" face="Times New Roman">if</font><font face="Times New Roman">(pos[i][1]&gt;maxn){</font></div><div align="left"><font face="Times New Roman">            maxn=pos[i][1];</font></div><div align="left"><font face="Times New Roman">            lena=1;</font></div><div align="left"><font face="Times New Roman">            ans[lena]=dict[i];</font></div><div align="left"><font face="Times New Roman">        }</font></div><div align="left"><font face="Times New Roman">    }</font></div><div align="left"><font face="Times New Roman">   </font> <font color="#0000FF" face="Times New Roman">for</font><font face="Times New Roman">(</font><font color="#0000FF" face="Times New Roman">int</font> <font face="Times New Roman">i=1;i&lt;lend;i++)</font></div><div align="left"><font face="Times New Roman">   </font> <font color="#0000FF" face="Times New Roman">if</font><font face="Times New Roman">(pos[i][1])</font></div><div align="left"><font face="Times New Roman">       </font> <font color="#0000FF" face="Times New Roman">for</font><font face="Times New Roman">(</font><font color="#0000FF" face="Times New Roman">int</font> <font face="Times New Roman">j=i+1;j&lt;=lend;j++)</font></div><div align="left"><font face="Times New Roman">       </font> <font color="#0000FF" face="Times New Roman">if</font><font face="Times New Roman">(pos[j][1] &amp;&amp; ((pos[i][0]&amp;pos[j][2])==0)){</font></div><div align="left"><font face="Times New Roman">           </font> <font color="#0000FF" face="Times New Roman">if</font><font face="Times New Roman">(pos[i][1]+pos[j][1]==maxn) ans[++lena]=dict[i]+</font><font color="#A31515" face="Times New Roman">' '</font><font face="Times New Roman">+dict[j];</font></div><div align="left"><font face="Times New Roman">           </font> <font color="#0000FF" face="Times New Roman">if</font><font face="Times New Roman">(pos[i][1]+pos[j][1]&gt;maxn){</font></div><div align="left"><font face="Times New Roman">                maxn=pos[i][1]+pos[j][1];</font></div><div align="left"><font face="Times New Roman">                lena=1;</font></div><div align="left"><font face="Times New Roman">                ans[lena]=dict[i]+</font> <font color="#A31515" face="Times New Roman">' '</font><font face="Times New Roman">+dict[j];</font></div><div align="left"><font face="Times New Roman">            }</font></div><div align="left"><font face="Times New Roman">        }</font></div><div align="left"><font face="Times New Roman">    ans[0][0]=</font><font color="#A31515" face="Times New Roman">'0'</font><font face="Times New Roman">;</font></div><div align="left"><font face="Times New Roman">    qsort(ans,lena+1,</font> <font color="#0000FF" face="Times New Roman">sizeof</font><font face="Times New Roman">(ans[0]),cmp);</font></div><div align="left"><font face="Times New Roman">    fout&lt;&lt;maxn&lt;&lt;endl;</font></div><div align="left"><font face="Times New Roman">   </font> <font color="#0000FF" face="Times New Roman">for</font><font face="Times New Roman">(</font><font color="#0000FF" face="Times New Roman">int</font> <font face="Times New Roman">i=1;i&lt;=lena;i++) fout&lt;&lt;ans[i]&lt;&lt;endl;</font></div><div align="left"><font face="Times New Roman">                </font> <font color="#0000FF" face="Times New Roman">return</font> <font face="Times New Roman">0;</font></div><div align="left"><font face="Times New Roman">}</font></div></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>注意事项</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">NO.</span></font></div><div align="justify"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>难易等级</b></span></font><font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt"><b> Easy(noip the 3rd)</b></span></font></div></div>
</div></body></html> 