<html>
<head>
  <title>USACO 5.2.2 fence3</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/268868 (zh-CN); Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1710"/>
<h1>USACO 5.2.2 fence3</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div align="left" style="text-indent: 0mm; margin: 4.75mm 0mm;"><font color="#010101" face="Arial"><span style="font-size: 13pt;"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size: 13pt;"><b>解题报告</b></span></font><font color="#010101" face="Arial"><span style="font-size: 13pt;"><b>]</b></span></font></div><div align="left" style="text-indent: 0mm; margin: 4.75mm 0mm;"><font color="#010101" face="宋体" size="4">模拟退火算法，可以加入随机化进行加速。基本思想很简单就是迭代逼近，USACO官方给的解答是先随机找一个点然后在一个给定的步长范围内以随机方向连续走，不断的更新这个点。从题目上看，精度要求不高，可以使用简单的退火算法来解决。首先是界定整张二维图的大小，然后我们用初始步长STEP网格搜索出当前的最好的点，那么可以知道，精确的最优点一定在这个点的附近，我们就在这个点的附近继续找，但是这回不是遍历整张图了，而是在刚才以STEP为半径或方形边长(STEP*2)所包围的最优点的范围内去找,在这个范围外的点都不如当前最优点好。</font><span style="color: rgb(1, 1, 1); font-family: 宋体; font-size: large;">接着STEP的大小缩小，如乘以1/10等（也可以用别的方式）</span><span style="color: rgb(1, 1, 1); font-family: 宋体; font-size: large; text-indent: 0mm;">.依次类推，这种退火算法就可以逐步找到最佳点。问题是控制在什么精度合适。首先题目要求输出一位小数，所以我们可以先把地图长度放大10倍，这样我们最后找到STEP = 1的最佳点就是最优结果了。</span></div><div align="left" style="text-indent: 0mm; margin: 4.75mm 0mm;"><font color="#010101" face="宋体" size="4">不过，严格意义上说，退火算法应该与随机化结合，这道题目的数据范围不大，不加入随机化也可以很快AC的。这种分层次逐步逼近的思想在找到一个大规模地图上的较优解时，速度很快。本题目在计算全部距离之和时，要使用一点初中的几何知识。还需要注意的是，第一次扫描的步长可能比地图本身还大，这个时候点不会更新到正确的位置（想想为什么），所以我们判断一下，如果出现这种情况就不要更新当前最优点，否则可能会更坏。</font></div><div align="left" style="text-indent: 0mm; margin: 4.75mm 0mm;"><font color="#010101" face="Arial"><span style="font-size: 13pt;"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size: 13pt;"><b>运行情况</b></span></font><font color="#010101" face="Arial"><span style="font-size: 13pt;"><b>]</b></span></font></div><div align="left" style="text-indent: 0mm; margin: 4.75mm 0mm;"><pre style="text-align: start;">
Compiling...
Compile: OK

Executing...
   Test 1: TEST OK [0.000 secs, 3232 KB]
   Test 2: TEST OK [0.000 secs, 3232 KB]
   Test 3: TEST OK [0.000 secs, 3232 KB]
   Test 4: TEST OK [0.000 secs, 3232 KB]
   Test 5: TEST OK [0.000 secs, 3232 KB]
   Test 6: TEST OK [0.000 secs, 3232 KB]
   Test 7: TEST OK [0.000 secs, 3232 KB]
   Test 8: TEST OK [0.000 secs, 3232 KB]
   Test 9: TEST OK [0.000 secs, 3232 KB]
   Test 10: TEST OK [0.000 secs, 3232 KB]
   Test 11: TEST OK [0.000 secs, 3232 KB]
   Test 12: TEST OK [0.000 secs, 3232 KB]

All tests OK.
<br><b>YOUR PROGRAM ('fence3') WORKED FIRST TIME!</b>  That's fantastic
-- and a rare thing.  Please accept these special automated
congratulations.
</pre></div><div align="left" style="text-indent: 0mm; margin: 4.75mm 0mm;"><font color="#010101" face="Arial"><span style="font-size: 13pt;"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size: 13pt;"><b>程序清单</b></span></font><font color="#010101" face="Arial"><span style="font-size: 13pt;"><b>]</b></span></font></div><div align="left" style="text-indent: 0mm; margin: 4.75mm 0mm;"><div align="left"><pre style="line-height: 12pt; font-size: 13px; background-color: rgb(255, 255, 236);"><span style="color: rgb(51, 153, 0);">#include &lt;iostream&gt; //模拟退火算法,迭代逼近
</span><span style="line-height: 12pt; text-indent: 0mm; color: rgb(51, 153, 0);">#include &lt;cstdio&gt;
</span><span style="line-height: 12pt; text-indent: 0mm; color: rgb(51, 153, 0);">#include &lt;cstring&gt;
</span><span style="line-height: 12pt; text-indent: 0mm; color: rgb(51, 153, 0);">#include &lt;string&gt;
</span><span style="line-height: 12pt; text-indent: 0mm; color: rgb(51, 153, 0);">#include &lt;cmath&gt;
</span><span style="line-height: 12pt; text-indent: 0mm; color: rgb(51, 153, 0);">#include &lt;iomanip&gt; // 显示小数点</span></pre><pre style="line-height: 12pt; font-size: 13px; background-color: rgb(255, 255, 236);"><span style="color: rgb(51, 153, 0);">#define MAX(a, b) (a &gt; b? a : b)
</span><span style="color: rgb(51, 153, 0);">#define MIN(a, b) (a &lt; b? a : b)
</span><span style="color: rgb(51, 153, 0);">#define prec 0.0000001
</span><span style="color: rgb(51, 153, 0);">#define INF 0x7FFFFFFF</span>
 
<span style="color: rgb(0, 0, 255);">using</span> <span style="color: rgb(0, 0, 255);">namespace</span> std<span style="color: rgb(0, 128, 128);">;</span>
 
<span style="color: rgb(0, 0, 255);">struct</span> fence<span style="color: rgb(0, 128, 0);">{</span>
        <span style="color: rgb(0, 0, 255);">int</span> x1, y1, x2, y2<span style="color: rgb(0, 128, 128);">;
</span><span style="color: rgb(0, 128, 0);">}</span>Node<span style="color: rgb(0, 128, 0);">[</span><span style="color: rgb(0, 0, 221);">151</span><span style="color: rgb(0, 128, 0);">]</span>, map<span style="color: rgb(0, 128, 128);">;
</span><span style="color: rgb(0, 0, 255);">int</span> F, step<span style="color: rgb(0, 128, 0);">[</span><span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 128, 0);">{</span><span style="color: rgb(0, 0, 221);">0</span>, <span style="color: rgb(0, 0, 221);">50</span>, <span style="color: rgb(0, 0, 221);">10</span>, <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 0);">}</span>, s <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">3</span><span style="color: rgb(0, 128, 128);">;
</span><span style="color: rgb(0, 0, 255);">double</span> x, y, l<span style="color: rgb(0, 128, 128);">;</span> <span style="color: rgb(102, 102, 102);">//step是初始步长</span>
 
<span style="color: rgb(0, 0, 255);">inline</span> <span style="color: rgb(0, 0, 255);">void</span> swap<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">int</span> <span style="color: rgb(0, 0, 64);">&amp;</span>x, <span style="color: rgb(0, 0, 255);">int</span> <span style="color: rgb(0, 0, 64);">&amp;</span>y<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
        <span style="color: rgb(0, 0, 255);">int</span> temp <span style="color: rgb(0, 0, 128);">=</span> x<span style="color: rgb(0, 128, 128);">;</span>
        x <span style="color: rgb(0, 0, 128);">=</span> y<span style="color: rgb(0, 128, 128);">;</span>
        y <span style="color: rgb(0, 0, 128);">=</span> temp<span style="color: rgb(0, 128, 128);">;
</span><span style="color: rgb(0, 128, 0);">}</span>
 
<span style="color: rgb(0, 0, 255);">inline</span> <span style="color: rgb(0, 0, 255);">double</span> dist<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">int</span> x1, <span style="color: rgb(0, 0, 255);">int</span> y1, <span style="color: rgb(0, 0, 255);">int</span> x2, <span style="color: rgb(0, 0, 255);">int</span> y2<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
        <span style="color: rgb(0, 0, 255);">return</span> <span style="color: rgb(0, 0, 221);">sqrt</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">(</span>x1<span style="color: rgb(0, 0, 64);">-</span>x2<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 0, 64);">*</span><span style="color: rgb(0, 128, 0);">(</span>x1<span style="color: rgb(0, 0, 64);">-</span>x2<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 0, 64);">+</span><span style="color: rgb(0, 128, 0);">(</span>y1<span style="color: rgb(0, 0, 64);">-</span>y2<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 0, 64);">*</span><span style="color: rgb(0, 128, 0);">(</span>y1<span style="color: rgb(0, 0, 64);">-</span>y2<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;
</span><span style="color: rgb(0, 128, 0);">}</span>
 
<span style="color: rgb(0, 0, 255);">double</span> totdist<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">const</span> <span style="color: rgb(0, 0, 255);">double</span> <span style="color: rgb(0, 0, 64);">&amp;</span>x, <span style="color: rgb(0, 0, 255);">const</span> <span style="color: rgb(0, 0, 255);">double</span> <span style="color: rgb(0, 0, 64);">&amp;</span>y<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
        <span style="color: rgb(0, 0, 255);">double</span> tot  <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">int</span> i <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 128);">;</span> i <span style="color: rgb(0, 0, 128);">&lt;=</span> F<span style="color: rgb(0, 128, 128);">;</span> i<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y1</span> <span style="color: rgb(0, 0, 128);">==</span> Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y2</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span> <span style="color: rgb(102, 102, 102);">// 平行于x</span>
                        <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>x <span style="color: rgb(0, 0, 128);">&gt;=</span> Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">x1</span> <span style="color: rgb(0, 0, 64);">&amp;&amp;</span> x <span style="color: rgb(0, 0, 128);">&lt;=</span> Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">x2</span><span style="color: rgb(0, 128, 0);">)</span> <span style="color: rgb(102, 102, 102);">// 可以做垂线</span>
                                tot <span style="color: rgb(0, 0, 64);">+</span><span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">fabs</span><span style="color: rgb(0, 128, 0);">(</span>y <span style="color: rgb(0, 0, 64);">-</span> Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y1</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                        <span style="color: rgb(0, 0, 255);">else</span> <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>x <span style="color: rgb(0, 0, 128);">&gt;</span> Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">x2</span><span style="color: rgb(0, 128, 0);">)</span>
                                tot <span style="color: rgb(0, 0, 64);">+</span><span style="color: rgb(0, 0, 128);">=</span> dist<span style="color: rgb(0, 128, 0);">(</span>x, y, Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">x2</span>, Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y2</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                        <span style="color: rgb(0, 0, 255);">else</span>
                                tot <span style="color: rgb(0, 0, 64);">+</span><span style="color: rgb(0, 0, 128);">=</span> dist<span style="color: rgb(0, 128, 0);">(</span>x, y, Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">x1</span>, Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y1</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                <span style="color: rgb(0, 128, 0);">}</span><span style="color: rgb(0, 0, 255);">else</span><span style="color: rgb(0, 128, 0);">{</span>  <span style="color: rgb(102, 102, 102);">// 与y平行</span>
                        <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>y <span style="color: rgb(0, 0, 128);">&gt;=</span> Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y1</span> <span style="color: rgb(0, 0, 64);">&amp;&amp;</span> y <span style="color: rgb(0, 0, 128);">&lt;=</span> Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y2</span><span style="color: rgb(0, 128, 0);">)</span> <span style="color: rgb(102, 102, 102);">// 可以做垂线</span>
                                tot <span style="color: rgb(0, 0, 64);">+</span><span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">fabs</span><span style="color: rgb(0, 128, 0);">(</span>x <span style="color: rgb(0, 0, 64);">-</span> Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">x1</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                        <span style="color: rgb(0, 0, 255);">else</span> <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>y <span style="color: rgb(0, 0, 128);">&gt;</span> Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y2</span><span style="color: rgb(0, 128, 0);">)</span>
                                tot <span style="color: rgb(0, 0, 64);">+</span><span style="color: rgb(0, 0, 128);">=</span> dist<span style="color: rgb(0, 128, 0);">(</span>x, y, Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">x2</span>, Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y2</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                        <span style="color: rgb(0, 0, 255);">else</span>
                                tot <span style="color: rgb(0, 0, 64);">+</span><span style="color: rgb(0, 0, 128);">=</span> dist<span style="color: rgb(0, 128, 0);">(</span>x, y, Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">x1</span>, Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y1</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                <span style="color: rgb(0, 128, 0);">}</span>
        <span style="color: rgb(0, 128, 0);">}</span>
        <span style="color: rgb(0, 0, 255);">return</span>  tot<span style="color: rgb(0, 128, 128);">;
</span><span style="color: rgb(0, 128, 0);">}</span>
 
<span style="color: rgb(0, 0, 255);">inline</span> <span style="color: rgb(0, 0, 255);">void</span> anneal<span style="color: rgb(0, 128, 0);">(</span>fence map, <span style="color: rgb(0, 0, 255);">int</span> now<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
        <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">int</span> i <span style="color: rgb(0, 0, 128);">=</span> map.<span style="color: rgb(0, 119, 136);">x1</span> <span style="color: rgb(0, 0, 64);">-</span> step<span style="color: rgb(0, 128, 0);">[</span>now <span style="color: rgb(0, 0, 64);">-</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span> i <span style="color: rgb(0, 0, 128);">&lt;=</span> map.<span style="color: rgb(0, 119, 136);">x2</span> <span style="color: rgb(0, 0, 64);">+</span> step<span style="color: rgb(0, 128, 0);">[</span>now <span style="color: rgb(0, 0, 64);">-</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span> i <span style="color: rgb(0, 0, 64);">+</span><span style="color: rgb(0, 0, 128);">=</span> step<span style="color: rgb(0, 128, 0);">[</span>now<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">int</span> j <span style="color: rgb(0, 0, 128);">=</span> map.<span style="color: rgb(0, 119, 136);">y1</span> <span style="color: rgb(0, 0, 64);">-</span> step<span style="color: rgb(0, 128, 0);">[</span>now <span style="color: rgb(0, 0, 64);">-</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span> j <span style="color: rgb(0, 0, 128);">&lt;=</span> map.<span style="color: rgb(0, 119, 136);">y2</span> <span style="color: rgb(0, 0, 64);">+</span> step<span style="color: rgb(0, 128, 0);">[</span>now <span style="color: rgb(0, 0, 64);">-</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span> j <span style="color: rgb(0, 0, 64);">+</span><span style="color: rgb(0, 0, 128);">=</span> step<span style="color: rgb(0, 128, 0);">[</span>now<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                        <span style="color: rgb(0, 0, 255);">double</span> count <span style="color: rgb(0, 0, 128);">=</span> totdist<span style="color: rgb(0, 128, 0);">(</span>i, j<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                        <span style="color: rgb(0, 0, 255);">if</span> <span style="color: rgb(0, 128, 0);">(</span>l <span style="color: rgb(0, 0, 128);">&gt;</span> count<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                                l <span style="color: rgb(0, 0, 128);">=</span> count<span style="color: rgb(0, 128, 128);">;</span>
                                x <span style="color: rgb(0, 0, 128);">=</span> i<span style="color: rgb(0, 128, 128);">;</span>
                                y <span style="color: rgb(0, 0, 128);">=</span> j<span style="color: rgb(0, 128, 128);">;</span>
                        <span style="color: rgb(0, 128, 0);">}</span>
                <span style="color: rgb(0, 128, 0);">}</span>
        <span style="color: rgb(0, 128, 0);">}
</span><span style="color: rgb(0, 128, 0);">}</span>
 
<span style="color: rgb(0, 0, 255);">void</span> search<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
        <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">int</span> now <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 128);">;</span> now <span style="color: rgb(0, 0, 128);">&lt;=</span> s<span style="color: rgb(0, 128, 128);">;</span> now<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                anneal<span style="color: rgb(0, 128, 0);">(</span>map, now<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span> <span style="color: rgb(102, 102, 102);">//处理完第一次后，地图的边界就不重要了，因为这时已经有一个较优点了，以这个点为中心继续搜索</span>
                <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>x <span style="color: rgb(0, 0, 64);">!</span><span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">0</span> <span style="color: rgb(0, 0, 64);">&amp;&amp;</span> y <span style="color: rgb(0, 0, 64);">!</span><span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>  <span style="color: rgb(102, 102, 102);">//注意要更新过后才可以替换</span>
                        map.<span style="color: rgb(0, 119, 136);">x1</span> <span style="color: rgb(0, 0, 128);">=</span> map.<span style="color: rgb(0, 119, 136);">x2</span> <span style="color: rgb(0, 0, 128);">=</span> x<span style="color: rgb(0, 128, 128);">;</span>
                        map.<span style="color: rgb(0, 119, 136);">y1</span> <span style="color: rgb(0, 0, 128);">=</span> map.<span style="color: rgb(0, 119, 136);">y2</span> <span style="color: rgb(0, 0, 128);">=</span> y<span style="color: rgb(0, 128, 128);">;</span>
                <span style="color: rgb(0, 128, 0);">}</span>
        <span style="color: rgb(0, 128, 0);">}
</span><span style="color: rgb(0, 128, 0);">}</span>
 
<span style="color: rgb(0, 0, 255);">int</span> main<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
        <span style="color: rgb(0, 0, 221);">freopen</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(255, 0, 0);">&quot;fence3.in&quot;</span>, <span style="color: rgb(255, 0, 0);">&quot;r&quot;</span>, <span style="color: rgb(0, 0, 255);">stdin</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 221);">freopen</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(255, 0, 0);">&quot;fence3.out&quot;</span>, <span style="color: rgb(255, 0, 0);">&quot;w&quot;</span>, <span style="color: rgb(0, 0, 255);">stdout</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
        map.<span style="color: rgb(0, 119, 136);">x1</span> <span style="color: rgb(0, 0, 128);">=</span> map.<span style="color: rgb(0, 119, 136);">y1</span> <span style="color: rgb(0, 0, 128);">=</span> l <span style="color: rgb(0, 0, 128);">=</span> INF<span style="color: rgb(0, 128, 128);">;</span>
        x <span style="color: rgb(0, 0, 128);">=</span> y <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(128, 0, 128);">0.0</span><span style="color: rgb(0, 128, 128);">;</span>
 
        <span style="color: rgb(0, 0, 221);">cin</span> <span style="color: rgb(0, 0, 128);">&gt;&gt;</span> F<span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">int</span> i <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 128);">;</span> i <span style="color: rgb(0, 0, 128);">&lt;=</span> F<span style="color: rgb(0, 128, 128);">;</span> i<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                <span style="color: rgb(0, 0, 221);">cin</span> <span style="color: rgb(0, 0, 128);">&gt;&gt;</span> Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">x1</span> <span style="color: rgb(0, 0, 128);">&gt;&gt;</span> Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y1</span> <span style="color: rgb(0, 0, 128);">&gt;&gt;</span> Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">x2</span> <span style="color: rgb(0, 0, 128);">&gt;&gt;</span> Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y2</span><span style="color: rgb(0, 128, 128);">;</span>  
                Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">x1</span> <span style="color: rgb(0, 0, 64);">*</span><span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">10</span>, Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y1</span> <span style="color: rgb(0, 0, 64);">*</span><span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">10</span>, Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">x2</span> <span style="color: rgb(0, 0, 64);">*</span><span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">10</span>, Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y2</span> <span style="color: rgb(0, 0, 64);">*</span><span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">10</span><span style="color: rgb(0, 128, 128);">;</span>
                <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">x1</span> <span style="color: rgb(0, 0, 128);">&gt;</span> Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">x2</span><span style="color: rgb(0, 128, 0);">)</span> swap<span style="color: rgb(0, 128, 0);">(</span>Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">x1</span>, Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">x2</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y1</span> <span style="color: rgb(0, 0, 128);">&gt;</span> Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y2</span><span style="color: rgb(0, 128, 0);">)</span> swap<span style="color: rgb(0, 128, 0);">(</span>Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y1</span>, Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y2</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span><span style="color: rgb(102, 102, 102);">//因为都是平行于坐标轴所以这样的交换没有Bug</span>
                map.<span style="color: rgb(0, 119, 136);">x1</span> <span style="color: rgb(0, 0, 128);">=</span> MIN<span style="color: rgb(0, 128, 0);">(</span>Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">x1</span>, map.<span style="color: rgb(0, 119, 136);">x1</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                map.<span style="color: rgb(0, 119, 136);">y1</span> <span style="color: rgb(0, 0, 128);">=</span> MIN<span style="color: rgb(0, 128, 0);">(</span>Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y1</span>, map.<span style="color: rgb(0, 119, 136);">y1</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                map.<span style="color: rgb(0, 119, 136);">x2</span> <span style="color: rgb(0, 0, 128);">=</span> MAX<span style="color: rgb(0, 128, 0);">(</span>Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">x2</span>, map.<span style="color: rgb(0, 119, 136);">x2</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                map.<span style="color: rgb(0, 119, 136);">y2</span> <span style="color: rgb(0, 0, 128);">=</span> MAX<span style="color: rgb(0, 128, 0);">(</span>Node<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span>.<span style="color: rgb(0, 119, 136);">y2</span>, map.<span style="color: rgb(0, 119, 136);">y2</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>               <span style="color: rgb(102, 102, 102);">//获得地图边界</span>
        <span style="color: rgb(0, 128, 0);">}</span>
 
        search<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
 
        <span style="color: rgb(0, 0, 221);">cout</span>.<span style="color: rgb(0, 119, 136);">precision</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 221);">cout</span>.<span style="color: rgb(0, 119, 136);">setf</span><span style="color: rgb(0, 128, 0);">(</span>ios<span style="color: rgb(0, 128, 128);">::</span><span style="color: rgb(0, 119, 136);">fixed</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 221);">cout</span> <span style="color: rgb(0, 0, 128);">&lt;&lt;</span> x<span style="color: rgb(0, 0, 64);">/</span><span style="color: rgb(128, 0, 128);">10.0</span> <span style="color: rgb(0, 0, 128);">&lt;&lt;</span> <span style="color: rgb(255, 0, 0);">' '</span> <span style="color: rgb(0, 0, 128);">&lt;&lt;</span> y<span style="color: rgb(0, 0, 64);">/</span><span style="color: rgb(128, 0, 128);">10.0</span> <span style="color: rgb(0, 0, 128);">&lt;&lt;</span> <span style="color: rgb(255, 0, 0);">' '</span> <span style="color: rgb(0, 0, 128);">&lt;&lt;</span> l<span style="color: rgb(0, 0, 64);">/</span><span style="color: rgb(128, 0, 128);">10.0</span> <span style="color: rgb(0, 0, 128);">&lt;&lt;</span> endl<span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 255);">return</span> <span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 128);">;
</span><span style="color: rgb(0, 128, 0);">}</span></pre></div></div><div align="left" style="text-indent: 0mm; margin: 4.75mm 0mm;"><font color="#010101" face="Arial"><span style="font-size: 13pt;"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size: 13pt;"><b>注意事项</b></span></font><font color="#010101" face="Arial"><span style="font-size: 13pt;"><b>]</b></span></font></div><div align="left" style="text-indent: 0mm; margin: 4.75mm 0mm;"><font color="#010101" face="宋体" size="2"><span style="font-size: 10pt;">无</span></font></div><div align="justify"><font color="#010101" face="Arial"><span style="font-size: 13pt;"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size: 13pt;"><b>难易等级</b></span></font><font color="#010101" face="Arial"><span style="font-size: 13pt;"><b>]</b></span></font><font color="#010101" face="宋体" size="2"><span style="font-size: 10pt;"><b> </b></span></font> <font color="#010101" face="Arial" size="2"><span style="font-size: 10pt;"><b>Medium(Noip 3rd)</b></span></font></div></div>
</div></body></html> 