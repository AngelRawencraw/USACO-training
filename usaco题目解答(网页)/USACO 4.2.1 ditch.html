<html>
<head>
  <title>USACO 4.2.1 ditch</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/268868 (zh-CN); Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="769"/>
<h1>USACO 4.2.1 ditch</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>解题报告</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体"><span style="font-size:12pt">网络流之母</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">--</span></font> <font color="#010101" face="宋体"><span style="font-size:12pt">最大流</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">具体的关于网络流的算法</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">这里不再赘述</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">主要说一下实现</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">:</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">我采用的实现方法是</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">DD_engi</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">大牛的</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">Dinic</span></font> <font color="#010101" face="宋体"><span style="font-size:12pt">版本</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">(</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">小菜第一个</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">netflow,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">第一次的感觉真好</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">),</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">因为</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">DD</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">的</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">netflow</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">代码应用了部分</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">c++</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">特性</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">比较简洁</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">采用边表存储</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">因为查找中凡是处理过的饱和边均要删掉</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">所以不必要</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">cap</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">与</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">flow</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">共存</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">用一个代替即可</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">又因为是边表所以遇到两点多边可以直接加边</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">如果是邻接矩阵则可以直接合并</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">流程很简单</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">:<br>
1.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">找到可以寻找增广路的充分条件</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">:</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">标号后汇点在集合中。<br></span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">2.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">更新最大流。</span></font><font color="#010101" face="Arial"><span style="font-size:12pt"><br>
3.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">重复上述。</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>运行情况</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">Compiling...<br>
Compile: OK</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">Executing...<br>
   Test 1: TEST OK [0.000 secs, 2948 KB]<br>
   Test 2: TEST OK [0.000 secs, 2948 KB]<br>
   Test 3: TEST OK [0.011 secs, 2948 KB]<br>
   Test 4: TEST OK [0.011 secs, 2948 KB]<br>
   Test 5: TEST OK [0.011 secs, 2948 KB]<br>
   Test 6: TEST OK [0.011 secs, 2948 KB]<br>
   Test 7: TEST OK [0.000 secs, 2948 KB]<br>
   Test 8: TEST OK [0.000 secs, 2948 KB]<br>
   Test 9: TEST OK [0.011 secs, 2948 KB]<br>
   Test 10: TEST OK [0.000 secs, 2948 KB]<br>
   Test 11: TEST OK [0.000 secs, 2948 KB]<br>
   Test 12: TEST OK [0.011 secs, 2948 KB]</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">All tests OK.<br></span><span style="font-size:10pt"><b>YOUR PROGRAM ('ditch') WORKED FIRST TIME!</b></span><span style="font-size:10pt"> That's fantastic<br>
-- and a rare thing. Please accept these special automated<br>
congratulations.</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">在</span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">DD_engi</span></font> <font color="#010101" face="宋体" size="2"><span style="font-size:10pt">的强化测试包中的运行效果</span></font> <font color="#010101" face="Arial" size="2"><span style="font-size:10pt">(</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">最大</span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">500000</span></font> <font color="#010101" face="宋体" size="2"><span style="font-size:10pt">条边</span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">,</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">在我的机子上</span></font> <font color="#010101" face="Arial" size="2"><span style="font-size:10pt">Dinic</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">比优化的</span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">SAP</span></font> <font color="#010101" face="宋体" size="2"><span style="font-size:10pt">快</span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">):<br></span></font><img src="USACO 4.2.1 ditch_files/Image.png" type="image/png" alt="http://hiphotos.baidu.com/adventop/pic/item/6a952dcb53a89db3c8176845.jpg" border="0" height="179" style="cursor: default;" width="448"/></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>程序清单</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#include</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&lt;cstdio&gt;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#include</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&lt;cstring&gt;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#include</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&lt;climits&gt;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">typedef</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">long</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">long</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">INT64;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">const</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">INT64 MAXN = 205;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//最大节点数目</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">struct</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">edge{ </span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//使用边表存储</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">x,y,cap;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//边的两边分别是x,y;容量是cap;因为本方法为阻塞流法所以仅需容量;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    edge *next,*target;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//以x为表头的邻接边和反向边;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    edge(){}</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//缺省构造函数</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    edge(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">x,</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">y,</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">c,edge *n):x(x),y(y),cap(c),next(n),target(0){}</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//自定义构造函数</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">*</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">operator</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">new</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">(size_t,</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">*ptr){</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">ptr;}</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//重载new运算符</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}*EDGE[MAXN];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">INT64 MAXTOTAL; </span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//记录最大流</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">long</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">N,M,x,y,cap,Source,Sink,Queue[10*MAXN],Dist[MAXN];</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//Dist为分层图层次</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">edge *path[MAXN],*Stack[MAXN];</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//分别记录增广路和回溯用栈</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">bool</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">RefreshDistLabel(){</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//分层图构造函数，同时寻找增广路</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">head=0,tail=0,now;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    memset(Dist,-1,</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">sizeof</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(Dist));</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    Dist[Source]=0;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//源点层次距离</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    Queue[++tail]=Source;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">while</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(head&lt;tail){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        now=Queue[++head];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(edge *e=EDGE[now];e;e=e-&gt;next){</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//查看所有邻接</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(e-&gt;cap==0)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">continue</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//已经无边则跳过</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(Dist[e-&gt;y]==-1){</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//未扩展</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                Dist[e-&gt;y]=Dist[e-&gt;x]+1;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//从上个层次扩展.(e-&gt;x换成now也可以)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                Queue[++tail]=e-&gt;y;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(e-&gt;y==Sink)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">1;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//找到合法层次则退出</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">FindMaxFlow(){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">Lpath=1,top=Source,record,delta;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    memcpy(Stack,EDGE,</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">sizeof</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(EDGE));</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">while</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(top&gt;0){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(top==Sink){</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//找到增广路</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            delta=INT_MAX;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;Lpath;i++)</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//找到可增广最小条件</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(delta&gt;path[i]-&gt;cap){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                    delta=path[i]-&gt;cap;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                    record=i;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//记录增广后的继承出发点</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;Lpath;i++){</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//增广</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                path[i]-&gt;cap-=delta;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                path[i]-&gt;target-&gt;cap+=delta;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            Lpath=record;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//回溯</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            top=path[Lpath]-&gt;x;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//回溯</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            MAXTOTAL+=delta;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//更新最大流</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        edge *temE;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(temE=Stack[top];temE;temE=temE-&gt;next){</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//查看所有邻接</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(temE-&gt;cap==0)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">continue</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//不合法</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(Dist[top]+1==Dist[temE-&gt;y])</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">break</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//合法</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        Stack[top]=temE;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//记录当前的DFS位置</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(temE){</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//找到可增广点</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            path[Lpath++]=temE;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//入队</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            top=temE-&gt;y;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//深度优先增广</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">else</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">{</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//已经无法增广</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            Dist[top]=-1;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//删掉当前边</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(Lpath==1)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//如果无法增广则退出.(top也可以)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            top=path[--Lpath]-&gt;x;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//回溯</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">main(){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    freopen(</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;ditch.in&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,</span></font> <font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;r&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,stdin);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    freopen(</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;ditch.out&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,</span></font> <font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;w&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,stdout);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    scanf(</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;%d%d&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,&amp;M,&amp;N);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    Source=1;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    Sink=N;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    edge *tempedge=</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">new</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">edge[2*M];</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//临时交换边表</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">while</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(M--){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        scanf(</span></font> <font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;%d%d%d&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,&amp;x,&amp;y,&amp;cap);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        EDGE[x]=</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">new</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">((</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">*)tempedge++) edge(x,y,cap,EDGE[x]);</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//利用临时边表更新邻接边</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        EDGE[y]=</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">new</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">((</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">*)tempedge++) edge(y,x,0,EDGE[y]);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        EDGE[x]-&gt;target=EDGE[y];</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//反向边表</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        EDGE[y]-&gt;target=EDGE[x];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">while</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(RefreshDistLabel()) FindMaxFlow();</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    printf(</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;%lld\n&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,MAXTOTAL);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>注意事项</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><p><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">处理好边界即可</span></font></p><div align="justify"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>难易等级</b></span></font><font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt"><b> Middle Down(noi</b></span></font> <font color="#010101" face="宋体" size="2"><span style="font-size:10pt"><b>基础</b></span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt"><b>)</b></span></font></div></div>
</div></body></html> 