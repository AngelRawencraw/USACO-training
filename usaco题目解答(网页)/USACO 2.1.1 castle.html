<html>
<head>
  <title>USACO 2.1.1 castle</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/268868 (zh-CN); Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="470"/>
<h1>USACO 2.1.1 castle</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>解题报告</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体"><span style="font-size:12pt">这道题目不难，就是使用</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">Floodfill,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">其实是带记录的</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">DFS</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">，搜索部分不难，在合并房间的部分需要注意，应该先找</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">N</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">面的，因为对于一个格子来说</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">N</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">比</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">W</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">要更接近</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">W</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">面（不知这样说清楚不），只有这一点注意的</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>运行情况</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">Compiling...<br>
Compile: OK</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">Executing...<br>
   Test 1: TEST OK [0.011 secs, 2956 KB]<br>
   Test 2: TEST OK [0.011 secs, 2956 KB]<br>
   Test 3: TEST OK [0.022 secs, 2956 KB]<br>
   Test 4: TEST OK [0.022 secs, 2956 KB]<br>
   Test 5: TEST OK [0.000 secs, 2956 KB]<br>
   Test 6: TEST OK [0.011 secs, 2956 KB]<br>
   Test 7: TEST OK [0.011 secs, 2956 KB]<br>
   Test 8: TEST OK [0.011 secs, 2956 KB]</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">All tests OK.<br></span><span style="font-size:10pt"><b>YOUR PROGRAM ('castle') WORKED FIRST TIME!</b></span><span style="font-size:10pt"> That's fantastic<br>
-- and a rare thing. Please accept these special automated<br>
congratulations.</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>程序清单</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#include</span></font> <font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&lt;fstream&gt;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">using</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">namespace</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">std;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">ofstream fout (</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;castle.out&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,ios::out);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">ifstream fin (</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;castle.in&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,ios::in);</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">n,m,map[51][51],tmap[51][51],xmap[2501],smax=0,num=0,fx[4]={1,2,4,8},tt;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">char</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">p;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">floodfill(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">x,</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">y)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                tt++;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                tmap[x][y]=num;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">((15-map[x][y])&gt;0) map[x][y]=15-map[x][y];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">else</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">k=3;k&gt;=0;k--)</span></font><font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//从大到小可以过滤掉所有情况.</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                {</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">((map[x][y]-fx[k])&gt;=0) map[x][y]-=fx[k];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">else</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">continue</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">switch</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">(k)</span></font><font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//floodfill</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                {</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">case</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(0):</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">( tmap[x][y-1]==0) floodfill(x,y-1);</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">break</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">case</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(1):</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">( tmap[x-1][y]==0) floodfill(x-1,y);</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">break</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">case</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(2):</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">( tmap[x][y+1]==0) floodfill(x,y+1);</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">break</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">case</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(3):</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">( tmap[x+1][y]==0) floodfill(x+1,y);</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">break</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">(map[x][y]==0)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">break</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">main()</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                fin&gt;&gt;m&gt;&gt;n;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=n;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=m;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                fin&gt;&gt;map[i][j];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=n;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=m;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">(map[i][j]!=0)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                {</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                num++;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                tt=0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                floodfill(i,j);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                xmap[num]=tt;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//记录num号房间的面积</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">(tt&gt;smax) smax=tt;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                fout&lt;&lt;num&lt;&lt;endl&lt;&lt;smax&lt;&lt;endl;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//输出房间总数和最大面积</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">x=0,y=0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=m;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=n;i&gt;=1;i--)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                {</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                </span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//N</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">((i-1&gt;0)&amp;&amp;(tmap[i][j]!=tmap[i-1][j])&amp;&amp;((xmap[tmap[i][j]]+xmap[tmap[i-1][j]])&gt;smax))</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                {</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                                x=i;y=j;p=</span></font> <font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">'N'</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                                smax=xmap[tmap[i][j]]+xmap[tmap[i-1][j]];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                </span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//E</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">((j&lt;m)&amp;&amp;(tmap[i][j]!=tmap[i][j+1])&amp;&amp;((xmap[tmap[i][j]]+xmap[tmap[i][j+1]])&gt;smax))</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                {</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                                x=i;y=j;p=</span></font> <font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">'E'</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                                smax=xmap[tmap[i][j]]+xmap[tmap[i][j+1]];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                fout&lt;&lt;smax&lt;&lt;endl&lt;&lt;x&lt;&lt;</span></font> <font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">' '</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">&lt;&lt;y&lt;&lt;</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">' '</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">&lt;&lt;p&lt;&lt;endl;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>注意事项</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">注意记录状态。</span></font></div><div align="justify"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>难易等级</b></span></font><font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt"><b> Easy(noip the 2nd)</b></span></font></div></div></div>
</div></body></html> 