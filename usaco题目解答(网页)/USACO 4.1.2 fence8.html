<html>
<head>
  <title>USACO 4.1.2 fence8</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/268868 (zh-CN); Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="730"/>
<h1>USACO 4.1.2 fence8</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>解题报告</b></span></font><font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体"><span style="font-size:12pt">一道经典的</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">DFS-ID</span></font> <font color="#010101" face="宋体"><span style="font-size:12pt">算法问题</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">分析题目是一道多背包的背包</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.= =|||.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">因此模型很类似第三章的</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">rockers,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">可是本题目顺序无关</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">所以需要搜索</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">这是选择搜索的动机</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">但是问题的规模非常庞大</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">直接</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">DFS</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">必定要</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">TLE.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">所以先要使得状态缩小</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">方法很简单</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">:</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">先令背包和材料有序</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">接着累计背包总容量</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">Total.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">累计一个数组</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">numr[i]</span></font> <font color="#010101" face="宋体"><span style="font-size:12pt">表示从</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">1</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">到</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">i</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">块材料的总费用</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">然后我们很容易得到</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">:</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">既然序列已经有序了</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">那么如果</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">numr[j]&gt;Total,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">背包们肯定装不下这些材料</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">因此要找到一个</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">j'</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">使得至少满足</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">numr[j']&lt;=Total.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">而这个</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">j'</span></font> <font color="#010101" face="宋体"><span style="font-size:12pt">就是最大可行域</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">总状态压缩完毕</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体"><span style="font-size:12pt">接着分析一下序列</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">因为序列已经有序了</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">所以我们搜索任意一个序列使其返回一个最大值</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">当我们计算前</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">k</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">个材料的搜索值时会返回一个不大于</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">k</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">的数字</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">若返回的值小于</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">k,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">那么返回值就一定是最终结果</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">(</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">不知这样说清楚不清楚</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">= =).</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">因此可以</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">DFS-ID,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">这也是</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">DFS-ID</span></font> <font color="#010101" face="宋体"><span style="font-size:12pt">的动机</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">但是再加以分析</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">若我们不要确切的返回值</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">而是转化为判定性的问题使问题返回</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">true,false.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">分别表示</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font> <font color="#010101" face="宋体"><span style="font-size:12pt">当前长度的序列是否可以放入背包组</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">这样问题必定是</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">{...true,true,false...}</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">这样的序列</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font> <font color="#010101" face="宋体"><span style="font-size:12pt">易知</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">:k</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">可行</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,k-1</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">必定可行</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">所以我们可以二分答案</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体"><span style="font-size:12pt">具体的实现</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">:</span></font> <font color="#010101" face="宋体"><span style="font-size:12pt">我们先来粗略评估一下搜索顺序</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">因为目标已经有序了</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">所以对于每个给定长度</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">k.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">我们搜索</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">k</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">个阶段</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">每个阶段执行完并且可以进入下一个阶段的充分必要条件是</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">:</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">当且仅当在本阶段可以把当前材料分割出来</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">这样的话</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">我们可以把材料由大到小搜索</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">让其在搜索过程中自行剪枝</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">这是搜索顺序的选择</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体"><span style="font-size:12pt">剪枝</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">:</span></font> <font color="#010101" face="宋体"><span style="font-size:12pt">如果按照上面的方法做可以过</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">3</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">个点</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">(</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">我试过</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">= =).</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">因此要考虑强而有力的剪枝</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">首先</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">:</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">维护一个域</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,space</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">表示永远无法再利用的浪费空间</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">当当前背包的剩余空间小于最小的材料占用空间时</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">就要加入浪费空间</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">因为无法再用了</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">这样如果</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">(space&gt;Total-numr[k])</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">就保证后面的都不可行了</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">这是一个侧重于背包剩余空间的剪枝</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">;</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">还有一个剪枝</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">:</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">当材料中出现很多相同长度的材料时</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">我们发现</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">若其中一个材料只能装在空间为</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">pack[i]</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">的背包里</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font> <font color="#010101" face="宋体"><span style="font-size:12pt">那么另一种只能装在大于等于它的背包里</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">不可能装在反而小于他的背包里</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">细心一些也许你就能发现</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">:</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">实现这个优化要对背包容量也由小到大排序</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">这样面对一个材料序列</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">{...3,3,4,4,</span></font><font color="#0000FF" face="Arial"><span style="font-size:12pt">5</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#FF0000" face="Arial"><span style="font-size:12pt">5</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,6,6...}</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">我们倒序搜索到第一个</span></font><font color="#FF0000" face="Arial"><span style="font-size:12pt">5</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">时</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">如只能装在</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">3</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">号背包里</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">(</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">假设编号越大容积越大</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">),</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">那么可知</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">1,2</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">号肯定无法再装另一个</span></font> <font color="#0000FF" face="Arial"><span style="font-size:12pt">5</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font> <font color="#010101" face="宋体"><span style="font-size:12pt">所以搜索下一个阶段时</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">也就是面对下一个</span></font> <font color="#FF0000" face="Arial"><span style="font-size:12pt">5</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font> <font color="#010101" face="宋体"><span style="font-size:12pt">我们从</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">3</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">号包开始搜就行了</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体"><span style="font-size:12pt">以上两个优化前者面向背包本身</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">好比对搜索树拦腰截断</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">使树变矮</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">;</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">后者面向搜索顺序</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">好比对每个枝杈修剪</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">使树变细</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">;</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">两者相辅相成缺一不可</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">这样原本一棵又高又粗地大树</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">被剪得又矮又细</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">搜索自然很快</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">.(^-^)</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>运行情况</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">Compiling...<br>
Compile: OK</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">Executing...<br>
   Test 1: TEST OK [0.000 secs, 2936 KB]<br>
   Test 2: TEST OK [0.000 secs, 2936 KB]<br>
   Test 3: TEST OK [0.000 secs, 2936 KB]<br>
   Test 4: TEST OK [0.011 secs, 2936 KB]<br>
   Test 5: TEST OK [0.011 secs, 2936 KB]<br>
   Test 6: TEST OK [0.022 secs, 2936 KB]<br>
   Test 7: TEST OK [0.011 secs, 2936 KB]<br>
   Test 8: TEST OK [0.011 secs, 2936 KB]<br>
   Test 9: TEST OK [0.022 secs, 2936 KB]<br>
   Test 10: TEST OK [0.000 secs, 2936 KB]<br>
   Test 11: TEST OK [0.011 secs, 2936 KB]<br>
   Test 12: TEST OK [0.011 secs, 2936 KB]</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">All tests OK.<br>
Your program ('fence8') produced all correct answers! This is your<br>
submission #3 for this problem. </span><span style="font-size:10pt"><b>Congratulations!</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>程序清单</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#include</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&lt;fstream&gt;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#include</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&lt;cstdlib&gt;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">using</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">namespace</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">std;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">ofstream fout (</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;fence8.out&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,ios::out);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">ifstream fin (</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;fence8.in&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,ios::in);</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">long</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">n,m,mid,space,pack[51]={-1},rail[1024]={-1},total,numr[1024],bag[51];</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">compare(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">const</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">*a,</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">const</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">*b){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">(*(</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">*)a-*(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">*)b);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">bool</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">dfsid(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">deep,</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">pos){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(deep&lt;=0)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">true</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(space&gt;total-numr[mid])</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">false</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//cut 1</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=pos;i&lt;=n;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(bag[i]&gt;=rail[deep]){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        bag[i]-=rail[deep];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(bag[i]&lt;rail[1])</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            space+=bag[i];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(rail[deep]==rail[deep-1]){</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//cut 2</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(dfsid(deep-1,i))</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">true</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;}</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">else</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">(dfsid(deep-1,1))</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">true</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(bag[i]&lt;rail[1])</span></font><font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//trace</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            space-=bag[i];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        bag[i]+=rail[deep];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">false</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">main()</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    fin&gt;&gt;n;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=n;i++){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        fin&gt;&gt;pack[i];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        total+=pack[i];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    fin&gt;&gt;m;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=m;i++) fin&gt;&gt;rail[i];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    qsort(pack,n+1,</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">sizeof</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">long</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">),compare);</span></font><font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//cut 3</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    qsort(rail,m+1,</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">sizeof</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">long</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">),compare);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    rail[0]=pack[0]=0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=m;i++) numr[i]=numr[i-1]+rail[i];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">while</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(numr[m]&gt;total) m--;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">left=0,right=m;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    mid=(left+right)/2;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">while</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(left&lt;=right){</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//2分答案</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=n;i++) bag[i]=pack[i];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        space=0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(dfsid(mid,1)){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            left=mid+1;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            mid=(left+right)/2;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        }</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">else</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            right=mid-1;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            mid=(left+right)/2;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    fout&lt;&lt;mid&lt;&lt;endl;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>注意事项</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">无</span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">.</span></font> <font color="#010101" face="宋体" size="2"><span style="font-size:10pt">主要是剪枝</span></font> <font color="#010101" face="Arial" size="2"><span style="font-size:10pt">.</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">不过一开始我剪错了</span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">= = |||.</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">该好好反思一下了</span></font> <font color="#010101" face="Arial" size="2"><span style="font-size:10pt">.</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>程序推广</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">其实本题目的两个优化是所有</span></font> <font color="#010101" face="Arial" size="2"><span style="font-size:10pt">DFS</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">类的两个最常用也是最有用的优化</span></font> <font color="#010101" face="Arial" size="2"><span style="font-size:10pt">:</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">一种侧重结果</span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">,</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">一种侧重顺序</span></font> <font color="#010101" face="Arial" size="2"><span style="font-size:10pt">.</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">而且本题</span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">MS</span></font> <font color="#010101" face="宋体" size="2"><span style="font-size:10pt">是</span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">USACO</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">中的搜索剪枝最强题了</span></font> <font color="#010101" face="Arial" size="2"><span style="font-size:10pt">,</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">很值得推广</span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">.</span></font></div><div align="justify"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>难易等级</b></span></font><font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt"><b> Hard Down(noip the 4th)</b></span></font></div></div>
</div></body></html> 