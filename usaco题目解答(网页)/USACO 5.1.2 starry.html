<html>
<head>
  <title>USACO 5.1.2 starry</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/268868 (zh-CN); Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="853"/>
<h1>USACO 5.1.2 starry</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>解题报告</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体"><span style="font-size:12pt">先说说本题目的题解吧：</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">Floodfill+Hash</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">。先</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">Floodfill</span></font> <font color="#010101" face="宋体"><span style="font-size:12pt">分离出各个连通块，然后构造</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">8</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">个方向的</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">Hash,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">每个都要自左上向右下顺序扫描赋上键值，判断时还应当注意方块的长宽是否一样。加上这些判断就严谨了。速度也在</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">0.1s</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">以内。</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>运行情况</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">Compiling...<br>
Compile: OK</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">Executing...<br>
   Test 1: TEST OK [0.022 secs, 3152 KB]<br>
   Test 2: TEST OK [0.000 secs, 3152 KB]<br>
   Test 3: TEST OK [0.011 secs, 3152 KB]<br>
   Test 4: TEST OK [0.022 secs, 3152 KB]<br>
   Test 5: TEST OK [0.054 secs, 3152 KB]</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">All tests OK.<br>
Your program ('starry') produced all correct answers! This is your<br>
submission #3 for this problem. </span><span style="font-size:10pt"><b>Congratulations!</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>程序清单</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#include</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&lt;fstream&gt;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#include</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&lt;cstring&gt;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#include</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&lt;string&gt;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#define</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">MAX(a,b) (a&gt;b?a:b)</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#define</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">MIN(a,b) (a&lt;b?a:b)</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#define</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">MAXN 105</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#define</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">MAXL 505</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">using</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">namespace</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">std;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">ofstream fout (</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;starry.out&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,ios::out);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">ifstream fin (</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;starry.in&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,ios::in);</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">typedef</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">struct</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">char</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">ch;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">long</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">hash[9],chang,kuan;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}Pic;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">map[MAXN][MAXN],Use[MAXN][MAXN],use[MAXN][MAXN],w,h,m,n,Mm,Mn,xMm,xMn,Count,tot,lev;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">pos[][2]={{0,0},{0,1},{0,-1},{1,0},{-1,0},{1,1},{-1,-1},{1,-1},{-1,1}};</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">char</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">xmap[MAXN][MAXN],MAP[MAXN][MAXN];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">Pic starry[MAXL];</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">bool</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">check(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">now,</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">x,</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">y,</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">k){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">X=pos[now][0]+x,Y=pos[now][1]+y;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(map[X][Y]==k)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">1;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">else</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">floodfill(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">x,</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">y){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                m=MIN(m,x);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                n=MIN(n,y);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                Mm=MAX(Mm,x);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                Mn=MAX(Mn,y);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    Use[x][y]=1;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    map[x][y]=2;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=8;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(check(i,x,y,1))</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            floodfill(x+pos[i][0],y+pos[i][1]);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">Paint(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">x,</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">y,</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">now){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    xmap[x][y]=starry[now].ch;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                map[x][y]=0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=8;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(check(i,x,y,2))</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            Paint(x+pos[i][0],y+pos[i][1],now);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">cutpic(){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                memset(use,0,</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">sizeof</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(use));</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=m;i&lt;=Mm;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=n;j&lt;=Mn;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                use[i-m+1][j-n+1]=Use[i][j];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">work[MAXN][MAXN];</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">init(){memset(work,0,</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">sizeof</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">(work));lev=0;}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">long</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">BKDRHash(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">const</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">map[MAXN][MAXN]){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">Hash=0,seed=131313;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=xMn;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=xMm;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            Hash=Hash*seed+work[j][i];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">(Hash &amp; 0x7FFFFFFF);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">make(Pic &amp;New){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//1</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                Mm=Mm-m+1;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                Mn=Mn-n+1;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    init();</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=Mm;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=Mn;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            work[i][j]=use[i][j];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=Mm;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=Mn;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            work[i][j]=(work[i][j]?++lev:0);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    xMm=Mm;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    xMn=Mn;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    New.hash[1]=BKDRHash(work);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    New.chang=Mm;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    New.kuan=Mn;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//2</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    init();</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=Mm;i&gt;=1;i--)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=Mn;j&gt;=1;j--)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            work[Mn-j+1][Mm-i+1]=use[i][Mn-j+1];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=Mn;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=Mm;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            work[i][j]=(work[i][j]?++lev:0);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    xMm=Mn;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    xMn=Mm;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    New.hash[2]=BKDRHash(work);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//3</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    init();</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=Mm;i&gt;=1;i--)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=Mn;j&gt;=1;j--)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            work[Mm-i+1][Mn-j+1]=use[i][j];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=Mm;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=Mn;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            work[i][j]=(work[i][j]?++lev:0);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    xMm=Mm;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    xMn=Mn;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    New.hash[3]=BKDRHash(work);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//4</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    init();</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=Mm;i&gt;=1;i--)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=Mn;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            work[j][Mm-i+1]=use[i][Mn-j+1];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=Mn;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=Mm;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            work[i][j]=(work[i][j]?++lev:0);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    xMm=Mn;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    xMn=Mm;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    New.hash[4]=BKDRHash(work);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//5</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    init();</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=Mm;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=Mn;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            work[i][j]=use[i][Mn-j+1];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=Mm;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=Mn;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            work[i][j]=(work[i][j]?++lev:0);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    xMm=Mm;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    xMn=Mn;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    New.hash[5]=BKDRHash(work);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//6</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    init();</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=Mm;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=Mn;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            work[j][i]=use[i][j];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=Mn;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=Mm;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            work[i][j]=(work[i][j]?++lev:0);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    xMm=Mn;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    xMn=Mm;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    New.hash[6]=BKDRHash(work);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//7</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    init();</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=Mm;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=Mn;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            work[i][j]=use[Mm-i+1][j];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=Mm;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=Mn;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            work[i][j]=(work[i][j]?++lev:0);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    xMm=Mm;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    xMn=Mn;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    New.hash[7]=BKDRHash(work);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//8</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    init();</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=Mm;i&gt;=1;i--)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=Mn;j&gt;=1;j--)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            work[Mm-i+1][j]=use[i][j];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=Mn;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=Mm;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            work[i][j]=(work[i][j]?++lev:0);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    xMm=Mn;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    xMn=Mm;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    New.hash[8]=BKDRHash(work);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">DeleteInsert(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">const</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">Pic &amp;New){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=tot;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=8;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">k=j;k&lt;=8;k++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(starry[i].hash[j]==New.hash[k] &amp;&amp; ((starry[i].chang==New.chang &amp;&amp;starry[i].kuan==New.kuan)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                    || (starry[i].chang==New.kuan &amp;&amp;starry[i].kuan==New.chang)))</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    starry[++tot]=New;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    Count++;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    starry[tot].ch=(</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">char</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">)(</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">'a'</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">+Count-1);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">tot;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">main()</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    fin&gt;&gt;w&gt;&gt;h;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=h;i++)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=w;j++)fin&gt;&gt;MAP[i][j];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=h;i++)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=w;j++){map[i][j]=MAP[i][j]-</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">'0'</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;}</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=h;i++)</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=w;j++)xmap[i][j]=</span></font> <font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">'0'</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=h;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=w;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(map[i][j]==1){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                memset(Use,0,</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">sizeof</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(Use));</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                                Mm=Mn=-1;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                m=i;n=j;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                floodfill(i,j);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                                                                cutpic();</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                Pic New;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                make(New);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                Paint(i,j,DeleteInsert(New));</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=h;i++){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=w;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            fout&lt;&lt;xmap[i][j];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        fout&lt;&lt;endl;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>注意事项</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">Hash</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">要注意关键值</span></font></div><div align="justify"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>难易等级</b></span></font><font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt"><b> Middle(Noip 3rd)</b></span></font></div></div>
</div></body></html> 