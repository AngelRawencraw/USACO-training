<html>
<head>
  <title>USACO 4.3.2 prime3</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/268868 (zh-CN); Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="800"/>
<h1>USACO 4.3.2 prime3</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size: 17px;"><b>[解题报告]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体"><span style="font-size:12pt">这是一个比较优秀的枚举搜索题目。所用策略</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">:</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">构造</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">+</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">二分</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">+</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">枚举</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">+</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">剪枝。</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体"><span style="font-size:12pt">其实题目本身不难，我的方法是：先构造出所有要用到的素数，然后在这个已经压缩的状态空间中枚举。因为素数构造好了，所以检索一个数字是否是素数时可以直接二分。搜索时先要搜对角线，然后有两个顺序去继续搜索：</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">A,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">由内到外；</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">B,</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">由外到内。事实上对于这道题目，可以进行最大限度的剪枝才是好的顺序，所以综合考虑</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">B</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">是更好的选择。</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><img src="USACO 4.3.2 prime3_files/Image.jpg" type="image/jpeg" style="cursor: default;"/></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体"><span style="font-size:12pt">剪枝策略：</span></font><font color="#010101" face="Arial"><span style="font-size:12pt">(</span></font> <font color="#010101" face="宋体"><span style="font-size:12pt">以下剪枝缺一不可</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">)<br>
1.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">素数与加和判断。</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt"><br>
2.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">起始不为</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">0</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">的判断。</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt"><br>
3.</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">末尾为奇判断。</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体"><span style="font-size:12pt">总结，事实上我这样做并不能加快程序的速度，唯一的优点是空间小</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">(</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">对于</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">C++),</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">以及编程的难度小</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">(</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">虽然长，但是很好写，至少循环层次很少</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">)</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">。另外我做了</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">A</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">顺序的程序，第三个点就达到</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">13s!</span></font><font color="#010101" face="宋体"><span style="font-size:12pt">如有兴趣参观我的第一个程序可以联系我。</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>运行情况</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">Compiling...<br>
Compile: OK</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">Executing...<br>
   Test 1: TEST OK [0.119 secs, 2972 KB]<br>
   Test 2: TEST OK [0.140 secs, 2972 KB]<br>
   Test 3: TEST OK [0.151 secs, 2972 KB]<br>
   Test 4: TEST OK [0.238 secs, 2972 KB]<br>
   Test 5: TEST OK [0.227 secs, 2972 KB]<br>
   Test 6: TEST OK [0.637 secs, 2972 KB]<br>
   Test 7: TEST OK [0.637 secs, 2972 KB]<br>
   Test 8: TEST OK [0.799 secs, 2972 KB]<br>
   Test 9: TEST OK [1.220 secs, 2972 KB]<br>
   Test 10: TEST OK [1.696 secs, 2972 KB] //</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">我感觉我的程序是以时间换空间</span></font> <font color="#010101" face="Arial" size="2"><span style="font-size:10pt">= =|||<br>
All tests OK.<br><br>
Your program ('prime3') produced all correct answers! This is your<br>
submission #3 for this problem. Congratulations!</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>程序清单</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#include</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&lt;cstdio&gt;</span></font><font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//AC</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#include</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&lt;cstring&gt;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#include</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&lt;cmath&gt;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#define</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">BIG 1005</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">const</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">bool</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">LIE =</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">true</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">struct</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">node{</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">num[6],val;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}pri[BIG];</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">K1,Lenp,TOTAL,FIRST,ranc[6][6],RANC[BIG][6][6],outtot,multi[]={0,1,10,100,1000,10000};</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">inline</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">bool</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">checkprime(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">const</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">&amp;prime){</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//二分法查找</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(!(prime&amp;1))</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">false</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">left=1,right=Lenp,mid=(left+right)&gt;&gt;1;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">while</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(left&lt;right){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(prime&gt;pri[mid].val){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            left=mid+1;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            mid=(left+right)&gt;&gt;1;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">else</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            right=mid;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            mid=(left+right)&gt;&gt;1;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(prime==pri[left].val)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">true</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">false</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">inline</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">add(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">const</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">bool</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">&amp;lie,</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">const</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">&amp;pos,</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">const</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">&amp;len){</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//求和函数</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">sum=0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(lie)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=len;i++) sum+=ranc[i][pos];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">else</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=len;i++) sum+=ranc[pos][i];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">sum;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">inline</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">multiply(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">const</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">bool</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">&amp;lie,</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">const</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">&amp;pos){</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//求数字的函数</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">num=0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(lie)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=5;i++) num+=ranc[i][pos]*multi[6-i];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">else</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=5;i++) num+=ranc[pos][i]*multi[6-i];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">num;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">inline</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">multiply(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">const</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">bool</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">&amp;lie,</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">const</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">&amp;wh,</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">const</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">&amp;pos){</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//求数字的函数</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">num=0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(lie)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=5;i++) num+=RANC[wh][i][pos]*multi[6-i];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">else</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=5;i++) num+=RANC[wh][pos][i]*multi[6-i];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">num;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">inline</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">lastcheck(){</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//可行性判断，并生成最终方案</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">TOT2,TOT3,TOT4,TOT5,TOT6;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    TOT3=add(!LIE,2,5)-ranc[2][3];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    TOT4=add(!LIE,4,5)-ranc[4][3];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(TOT3&gt;TOTAL || TOT4&gt;TOTAL )</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    ranc[2][3]=TOTAL-TOT3;ranc[4][3]=TOTAL-TOT4;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    TOT2=multiply(LIE,3);TOT4=multiply(!LIE,2);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    TOT5=multiply(!LIE,3);TOT6=multiply(!LIE,4);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(!checkprime(TOT2) || !checkprime(TOT5) || !</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        checkprime(TOT4) || !checkprime(TOT6))</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    memcpy(RANC[++outtot],ranc,</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">sizeof</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(ranc));</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">bool</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">midpane2(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">lev){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(lev&gt;2){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        lastcheck();</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">true</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">switch</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(lev){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">case</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(1):</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">              </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=Lenp;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(pri[i].num[1]==ranc[1][1] &amp;&amp; pri[i].num[5]==ranc[5][1]</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                &amp;&amp; pri[i].num[2] &amp;&amp; pri[i].num[3] &amp;&amp; pri[i].num[4]){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i1=2;i1&lt;=4;i1++) ranc[i1][1]=pri[i].num[i1];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(!midpane2(lev+1))</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">false</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">break</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">case</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(2):</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">              </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=Lenp;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(pri[i].num[1]==ranc[1][5] &amp;&amp; pri[i].num[5]==ranc[5][5]</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                &amp;&amp; (pri[i].num[2]&amp;1) &amp;&amp; (pri[i].num[3]&amp;1) &amp;&amp; (pri[i].num[4]&amp;1)){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i1=2;i1&lt;=4;i1++) ranc[i1][5]=pri[i].num[i1];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(!midpane2(lev+1))</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">false</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">break</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">true</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">bool</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">midpane1(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">lev){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(lev&gt;2){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">TOT1,TOT2;</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//以下是可行性剪枝</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        TOT1=add(LIE,2,5)-ranc[3][2];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        TOT2=add(LIE,4,5)-ranc[3][4];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(TOT1&gt;TOTAL || TOT2&gt;TOTAL)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">true</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        ranc[3][2]=TOTAL-TOT1;ranc[3][4]=TOTAL-TOT2;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        TOT1=multiply(LIE,2);TOT2=multiply(LIE,4);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(!checkprime(TOT1) || !checkprime(TOT2))</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">true</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        midpane2(1);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">true</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">switch</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(lev){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">case</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(1):</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=Lenp;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(pri[i].num[1]==ranc[1][1] &amp;&amp; pri[i].num[5]==ranc[1][5]</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                &amp;&amp; pri[i].num[2] &amp;&amp; pri[i].num[3] &amp;&amp; pri[i].num[4]){</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//对于开头是否是0要剪枝</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i1=2;i1&lt;=4;i1++) ranc[1][i1]=pri[i].num[i1];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(!midpane1(lev+1))</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">false</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">break</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">case</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(2):</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">              </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=Lenp;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(pri[i].num[1]==ranc[5][1] &amp;&amp; pri[i].num[5]==ranc[5][5]</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                &amp;&amp; (pri[i].num[2]&amp;1) &amp;&amp; (pri[i].num[3]&amp;1) &amp;&amp; (pri[i].num[4]&amp;1)){</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//末尾的剪枝：判断是不是奇数</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i1=2;i1&lt;=4;i1++) ranc[5][i1]=pri[i].num[i1];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(!midpane1(lev+1))</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">false</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">break</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">true</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">inline</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">crosspane(){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=Lenp;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(pri[i].num[1]==FIRST){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i1=1;i1&lt;=5;i1++) ranc[i1][i1]=pri[i].num[i1];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=Lenp;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(pri[j].num[3]==ranc[3][3]){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j1=1;j1&lt;=5;j1++) ranc[j1][6-j1]=pri[j].num[6-j1];</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//以下是可行性剪枝，对于当前总和超过TOTAL的要剪掉</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(ranc[1][1]+ranc[1][5]&gt;TOTAL || ranc[1][1]+ranc[5][1]&gt;TOTAL || ranc[5][1]+ranc[5][5]&gt;TOTAL || ranc[1][5]+ranc[5][5]&gt;TOTAL ||</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                       ranc[2][2]+ranc[2][4]&gt;TOTAL || ranc[2][2]+ranc[4][2]&gt;TOTAL || ranc[4][2]+ranc[4][4]&gt;TOTAL || ranc[4][4]+ranc[4][2]&gt;TOTAL)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                      </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">continue</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                    midpane1(1);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">inline</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">bool</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">cmp(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">const</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">&amp;A,</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">const</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">&amp;B){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">ma,mb;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=5;i++){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        ma=multiply(!LIE,A,i);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        mb=multiply(!LIE,B,i);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(ma&lt;mb)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">true</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(ma==mb)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">continue</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(ma&gt;mb)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">false</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">false</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">inline</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">sort(){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">ranc[6][6];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;outtot;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=outtot-i;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(cmp(j,j+1)){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                memcpy(ranc,RANC[j],</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">sizeof</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(RANC[j]));</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                memcpy(RANC[j],RANC[j+1],</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">sizeof</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(RANC[j+1]));</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                memcpy(RANC[j+1],ranc,</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">sizeof</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(ranc));</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">main()</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    freopen(</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;prime3.in&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,</span></font> <font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;r&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,stdin);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    freopen(</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;prime3.out&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,</span></font> <font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;w&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,stdout);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    scanf(</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;%d%d&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,&amp;TOTAL,&amp;FIRST);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=10001;i&lt;=99997;i+=2){</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//提前构造出满足条件的素数</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">bool</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">flag=</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">false</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=2;j&lt;=(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">)sqrt(i);j++)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(i%j==0){flag=</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">true</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">break</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">;}</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(!flag){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">total=0,k=i,num[6],pos=0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">while</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(k&gt;0){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                num[6-(++pos)]=k%10;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                total+=num[6-pos];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                k/=10;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(total==TOTAL){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                memcpy(pri[++Lenp].num,num,</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">sizeof</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(num));</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                pri[Lenp].val=i;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    crosspane();</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    sort();</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//冒泡排序</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">k=outtot;k&gt;=1;k--){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=5;i++){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=5;j++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                printf(</span></font> <font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;%d&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,RANC[k][i][j]);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            printf(</span></font> <font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;\n&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(k!=1) printf(</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;\n&quot;</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(!outtot) printf(</span></font> <font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;NONE\n&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>注意事项</b></span></font><font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">搜索方式和顺序很重要！</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">A</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">顺序程序大小</span></font> <font color="#010101" face="Arial" size="2"><span style="font-size:10pt">6K(</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">未排序</span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">)</span></font> <font color="#010101" face="宋体" size="2"><span style="font-size:10pt">，</span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">B</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">顺序</span></font> <font color="#010101" face="Arial" size="2"><span style="font-size:10pt">7K.</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">强烈</span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">Orz nocow</span></font> <font color="#010101" face="宋体" size="2"><span style="font-size:10pt">上的一篇</span></font> <font color="#010101" face="Arial" size="2"><span style="font-size:10pt">Pascal</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">的程序。</span></font></div><div align="justify"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>难易等级</b></span></font><font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt"><b> Easy Up(noip the 4th)</b></span></font></div></div>
</div></body></html> 