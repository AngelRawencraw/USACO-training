<html>
<head>
  <title>USACO 5.4.5 telecow</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/268868 (zh-CN); Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1898"/>
<h1>USACO 5.4.5 telecow</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div align="left" style="text-indent: 0mm; text-align: -webkit-left; margin: 4.75mm 0mm;"><font face="黑体"><font color="#010101"><span style="font-size: 13pt;"><b>[</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>解题报告</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>]</b></span></font></font></div><div align="left" style="text-indent: 0mm; text-align: -webkit-left; margin: 4.75mm 0mm;"><div align="left" style="text-indent: 0mm; margin: 4.75mm 0mm;"><div><font color="#010101" face="宋体" size="4">本题目的大意是截断几个点之后从源到汇不连通，这就可以转化为一个网络流问题，求最小割方案。因为最大流等于最小割，我们建模的时候考虑到点的流量是1，这样最大流就恰好是最少需要的点。为了方便处理问题我们可以拆点来做，把点x拆成x1和x2，然后x1到x2的容量是1。然后如果x和y相连，那么我们就要建立有x2到y1，y2到x1两个容量无穷的边，这样，求出最大流第一问就解决了。</font></div><div><font color="#010101" face="宋体" size="4">具体的方案可以枚举每一个点，删掉后查看流量的变化，如果减少1那么就加入输出队列，并永久删除这个点，直到流量为0时，最小割方案就有了。</font></div></div></div><div align="left" style="text-indent: 0mm; text-align: -webkit-left; margin: 4.75mm 0mm;"><font face="黑体"><font color="#010101"><span style="font-size: 13pt;"><b>[</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>运行情况</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>]</b></span></font></font></div><div align="left" style="text-indent: 0mm; text-align: -webkit-left; margin: 4.75mm 0mm;"><pre style="text-align: start;"></pre><pre style="text-align: start;"></pre><pre>
Compiling...
Compile: OK

Executing...
   Test 1: TEST OK [0.000 secs, 5044 KB]
   Test 2: TEST OK [0.000 secs, 5044 KB]
   Test 3: TEST OK [0.000 secs, 5044 KB]
   Test 4: TEST OK [0.000 secs, 5044 KB]
   Test 5: TEST OK [0.000 secs, 5044 KB]
   Test 6: TEST OK [0.000 secs, 5044 KB]
   Test 7: TEST OK [0.000 secs, 5044 KB]
   Test 8: TEST OK [0.000 secs, 5044 KB]
   Test 9: TEST OK [0.011 secs, 5044 KB]
   Test 10: TEST OK [0.022 secs, 5044 KB]
   Test 11: TEST OK [0.032 secs, 5044 KB]

All tests OK.
<br><b>YOUR PROGRAM ('telecow') WORKED FIRST TIME!</b>  That's fantastic
-- and a rare thing.  Please accept these special automated
congratulations.
</pre></div><div align="left" style="text-indent: 0mm; text-align: -webkit-left; margin: 4.75mm 0mm;"><font face="黑体"><font color="#010101"><span style="font-size: 13pt;"><b>[</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>程序清单</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>]</b></span></font></font></div><div align="left" style="text-indent: 0mm; text-align: -webkit-left; margin: 4.75mm 0mm;"><div align="left"><pre style="line-height: 12pt; font-size: 13px; background-color: rgb(255, 255, 236);"></pre><div dir="ltr" lang="zh-cn" style="direction: ltr; text-align: start;"><div dir="ltr" style="text-align: left;"><pre style="line-height: 12pt;"></pre><div><pre style="font-size: 13px; line-height: 12pt; background-color: rgb(255, 255, 236);"></pre><pre style="line-height: 12pt;"></pre><pre style="background-color: rgb(255, 255, 236);"></pre><pre style="line-height: 12pt; font-size: 13px;"><span style="color: rgb(51, 153, 0);">#include &lt;iostream&gt;
</span><span style="color: rgb(51, 153, 0);">#include &lt;cstdio&gt;
</span><span style="color: rgb(51, 153, 0);">#include &lt;cstring&gt;
</span><span style="color: rgb(51, 153, 0);">#include &lt;climits&gt;
</span><span style="color: rgb(51, 153, 0);">#include &lt;queue&gt;
</span><span style="color: rgb(51, 153, 0);">#define MAXN 605</span>
 
<span style="color: rgb(0, 0, 255);">using</span> <span style="color: rgb(0, 0, 255);">namespace</span> std<span style="color: rgb(0, 128, 128);">;</span>
 
<span style="color: rgb(0, 0, 255);">typedef</span> <span style="color: rgb(0, 0, 255);">long</span> <span style="color: rgb(0, 0, 255);">long</span> INT64<span style="color: rgb(0, 128, 128);">;</span><span style="color: rgb(0, 0, 255);">struct</span> edge<span style="color: rgb(0, 128, 0);">{</span> 
    <span style="color: rgb(0, 0, 255);">int</span> x,y,cap<span style="color: rgb(0, 128, 128);">;</span>
    edge <span style="color: rgb(0, 0, 64);">*</span>next,<span style="color: rgb(0, 0, 64);">*</span>target<span style="color: rgb(0, 128, 128);">;</span> 
    edge<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span><span style="color: rgb(0, 128, 0);">}</span> 
    edge<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">int</span> x,<span style="color: rgb(0, 0, 255);">int</span> y,<span style="color: rgb(0, 0, 255);">int</span> c,edge <span style="color: rgb(0, 0, 64);">*</span>n<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">:</span>x<span style="color: rgb(0, 128, 0);">(</span>x<span style="color: rgb(0, 128, 0);">)</span>,y<span style="color: rgb(0, 128, 0);">(</span>y<span style="color: rgb(0, 128, 0);">)</span>,cap<span style="color: rgb(0, 128, 0);">(</span>c<span style="color: rgb(0, 128, 0);">)</span>,next<span style="color: rgb(0, 128, 0);">(</span>n<span style="color: rgb(0, 128, 0);">)</span>,target<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span><span style="color: rgb(0, 128, 0);">}</span> 
    <span style="color: rgb(0, 0, 255);">void</span> <span style="color: rgb(0, 0, 64);">*</span> operator <span style="color: rgb(0, 0, 221);">new</span> <span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">size_t</span>,<span style="color: rgb(0, 0, 255);">void</span> <span style="color: rgb(0, 0, 64);">*</span>ptr<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span><span style="color: rgb(0, 0, 255);">return</span> ptr<span style="color: rgb(0, 128, 128);">;</span><span style="color: rgb(0, 128, 0);">}</span> 
<span style="color: rgb(0, 128, 0);">}</span><span style="color: rgb(0, 0, 64);">*</span>EDGE<span style="color: rgb(0, 128, 0);">[</span>MAXN<span style="color: rgb(0, 128, 0);">]</span>, <span style="color: rgb(0, 0, 64);">*</span>tempedge<span style="color: rgb(0, 0, 128);">=</span><span style="color: rgb(0, 0, 221);">new</span> edge<span style="color: rgb(0, 128, 0);">[</span><span style="color: rgb(0, 0, 221);">4000</span><span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span>
INT64 totalflow, MAXF<span style="color: rgb(0, 128, 128);">;
</span><span style="color: rgb(0, 0, 255);">long</span> N, M, x, y, cap, Source, Sink, Queue<span style="color: rgb(0, 128, 0);">[</span><span style="color: rgb(0, 0, 221);">10</span> <span style="color: rgb(0, 0, 64);">*</span> MAXN<span style="color: rgb(0, 128, 0);">]</span>, Dist<span style="color: rgb(0, 128, 0);">[</span>MAXN<span style="color: rgb(0, 128, 0);">]</span>, temp, anse<span style="color: rgb(0, 128, 0);">[</span>MAXN<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">[</span>MAXN<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span>
edge <span style="color: rgb(0, 0, 64);">*</span>path<span style="color: rgb(0, 128, 0);">[</span>MAXN<span style="color: rgb(0, 128, 0);">]</span>, <span style="color: rgb(0, 0, 64);">*</span>Stack<span style="color: rgb(0, 128, 0);">[</span>MAXN<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span>
queue<span style="color: rgb(0, 0, 128);">&lt;</span><span style="color: rgb(0, 0, 255);">int</span><span style="color: rgb(0, 0, 128);">&gt;</span> que<span style="color: rgb(0, 128, 128);">;</span>
 
<span style="color: rgb(0, 0, 255);">bool</span> RefreshDistLabel<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
        <span style="color: rgb(0, 0, 255);">int</span> head <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">0</span>, tail <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">0</span>, now<span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 221);">memset</span><span style="color: rgb(0, 128, 0);">(</span>Dist, <span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 221);">1</span>, <span style="color: rgb(0, 0, 221);">sizeof</span><span style="color: rgb(0, 128, 0);">(</span>Dist<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
        Dist<span style="color: rgb(0, 128, 0);">[</span>Source<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 128);">;</span>
        Queue<span style="color: rgb(0, 128, 0);">[</span><span style="color: rgb(0, 0, 64);">++</span>tail<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> Source<span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 255);">while</span><span style="color: rgb(0, 128, 0);">(</span>head <span style="color: rgb(0, 0, 128);">&lt;</span> tail<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                now <span style="color: rgb(0, 0, 128);">=</span> Queue<span style="color: rgb(0, 128, 0);">[</span><span style="color: rgb(0, 0, 64);">++</span>head<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span>
                <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span>edge <span style="color: rgb(0, 0, 64);">*</span>e <span style="color: rgb(0, 0, 128);">=</span> EDGE<span style="color: rgb(0, 128, 0);">[</span>now<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span> e<span style="color: rgb(0, 128, 128);">;</span> e <span style="color: rgb(0, 0, 128);">=</span> e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>next<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                        <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>cap<span style="color: rgb(0, 0, 128);">==</span><span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 0);">)</span> <span style="color: rgb(0, 0, 255);">continue</span><span style="color: rgb(0, 128, 128);">;</span>
                        <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>Dist<span style="color: rgb(0, 128, 0);">[</span>e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>y<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">==</span> <span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                                Dist<span style="color: rgb(0, 128, 0);">[</span>e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>y<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> Dist<span style="color: rgb(0, 128, 0);">[</span>e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>x<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 64);">+</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 128);">;</span>
                                Queue<span style="color: rgb(0, 128, 0);">[</span><span style="color: rgb(0, 0, 64);">++</span>tail<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>y<span style="color: rgb(0, 128, 128);">;</span>
                                <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>y <span style="color: rgb(0, 0, 128);">==</span> Sink<span style="color: rgb(0, 128, 0);">)</span> <span style="color: rgb(0, 0, 255);">return</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 128);">;</span>
                        <span style="color: rgb(0, 128, 0);">}</span>
                <span style="color: rgb(0, 128, 0);">}</span>
        <span style="color: rgb(0, 128, 0);">}</span>
        <span style="color: rgb(0, 0, 255);">return</span> <span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 128);">;
</span><span style="color: rgb(0, 128, 0);">}
</span><span style="color: rgb(0, 0, 255);">void</span> FindMaxFlow<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
        <span style="color: rgb(0, 0, 255);">int</span> Lpath <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">1</span>, top <span style="color: rgb(0, 0, 128);">=</span> Source, record, delta<span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 221);">memcpy</span><span style="color: rgb(0, 128, 0);">(</span>Stack, EDGE, <span style="color: rgb(0, 0, 221);">sizeof</span><span style="color: rgb(0, 128, 0);">(</span>EDGE<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 255);">while</span><span style="color: rgb(0, 128, 0);">(</span>top <span style="color: rgb(0, 0, 128);">&gt;</span> <span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>top <span style="color: rgb(0, 0, 128);">==</span> Sink<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                        delta <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 255);">INT_MAX</span><span style="color: rgb(0, 128, 128);">;</span>
                        <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">int</span> i <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 128);">;</span> i <span style="color: rgb(0, 0, 128);">&lt;</span> Lpath<span style="color: rgb(0, 128, 128);">;</span> i<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span>
                                <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>delta <span style="color: rgb(0, 0, 128);">&gt;</span> path<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>cap<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                                        delta <span style="color: rgb(0, 0, 128);">=</span> path<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>cap<span style="color: rgb(0, 128, 128);">;</span>
                                        record <span style="color: rgb(0, 0, 128);">=</span> i<span style="color: rgb(0, 128, 128);">;</span>
                                <span style="color: rgb(0, 128, 0);">}</span>
                        <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">int</span> i <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 128);">;</span> i <span style="color: rgb(0, 0, 128);">&lt;</span> Lpath<span style="color: rgb(0, 128, 128);">;</span> i<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                                path<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>cap <span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">=</span> delta<span style="color: rgb(0, 128, 128);">;</span>
                                path<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>target<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>cap <span style="color: rgb(0, 0, 64);">+</span><span style="color: rgb(0, 0, 128);">=</span> delta<span style="color: rgb(0, 128, 128);">;</span>
                        <span style="color: rgb(0, 128, 0);">}</span>
                        Lpath <span style="color: rgb(0, 0, 128);">=</span> record<span style="color: rgb(0, 128, 128);">;</span>
                        top <span style="color: rgb(0, 0, 128);">=</span> path<span style="color: rgb(0, 128, 0);">[</span>Lpath<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>x<span style="color: rgb(0, 128, 128);">;</span>
                        totalflow <span style="color: rgb(0, 0, 64);">+</span><span style="color: rgb(0, 0, 128);">=</span> delta<span style="color: rgb(0, 128, 128);">;</span>
                <span style="color: rgb(0, 128, 0);">}</span>
                edge <span style="color: rgb(0, 0, 64);">*</span>temE<span style="color: rgb(0, 128, 128);">;</span>
                <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span>temE <span style="color: rgb(0, 0, 128);">=</span> Stack<span style="color: rgb(0, 128, 0);">[</span>top<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span> temE<span style="color: rgb(0, 128, 128);">;</span> temE <span style="color: rgb(0, 0, 128);">=</span> temE<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>next<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                        <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>temE<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>cap <span style="color: rgb(0, 0, 128);">==</span> <span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 0);">)</span> <span style="color: rgb(0, 0, 255);">continue</span><span style="color: rgb(0, 128, 128);">;</span>
                        <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>Dist<span style="color: rgb(0, 128, 0);">[</span>top<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 64);">+</span> <span style="color: rgb(0, 0, 221);">1</span> <span style="color: rgb(0, 0, 128);">==</span> Dist<span style="color: rgb(0, 128, 0);">[</span>temE<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>y<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">)</span> <span style="color: rgb(0, 0, 255);">break</span><span style="color: rgb(0, 128, 128);">;</span>
                <span style="color: rgb(0, 128, 0);">}</span>
                Stack<span style="color: rgb(0, 128, 0);">[</span>top<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> temE<span style="color: rgb(0, 128, 128);">;</span>
                <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>temE<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                        path<span style="color: rgb(0, 128, 0);">[</span>Lpath<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> temE<span style="color: rgb(0, 128, 128);">;</span>
                        top <span style="color: rgb(0, 0, 128);">=</span> temE<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>y<span style="color: rgb(0, 128, 128);">;</span>
                <span style="color: rgb(0, 128, 0);">}</span><span style="color: rgb(0, 0, 255);">else</span><span style="color: rgb(0, 128, 0);">{</span>
                        Dist<span style="color: rgb(0, 128, 0);">[</span>top<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 128);">;</span>
                        <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>Lpath <span style="color: rgb(0, 0, 128);">==</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 0);">)</span> <span style="color: rgb(0, 0, 255);">return</span><span style="color: rgb(0, 128, 128);">;</span>
                        top <span style="color: rgb(0, 0, 128);">=</span> path<span style="color: rgb(0, 128, 0);">[</span><span style="color: rgb(0, 0, 64);">--</span>Lpath<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>x<span style="color: rgb(0, 128, 128);">;</span>
                <span style="color: rgb(0, 128, 0);">}</span>
        <span style="color: rgb(0, 128, 0);">}
</span><span style="color: rgb(0, 128, 0);">}</span>
 
<span style="color: rgb(0, 0, 255);">inline</span> <span style="color: rgb(0, 0, 255);">void</span> build<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">int</span> x, <span style="color: rgb(0, 0, 255);">int</span> y<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
        <span style="color: rgb(0, 0, 255);">int</span> x1 <span style="color: rgb(0, 0, 128);">=</span> x, y1 <span style="color: rgb(0, 0, 128);">=</span> y, x2 <span style="color: rgb(0, 0, 128);">=</span> x <span style="color: rgb(0, 0, 64);">+</span> N, y2 <span style="color: rgb(0, 0, 128);">=</span> y <span style="color: rgb(0, 0, 64);">+</span> N, fx <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">1</span>, fy <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(102, 102, 102);">//拆点,只拆一次</span>
        <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>x <span style="color: rgb(0, 0, 128);">==</span> Source<span style="color: rgb(0, 128, 0);">)</span> fx <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 255);">INT_MAX</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>y <span style="color: rgb(0, 0, 128);">==</span> Source<span style="color: rgb(0, 128, 0);">)</span> fy <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 255);">INT_MAX</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 64);">!</span>EDGE<span style="color: rgb(0, 128, 0);">[</span>x1<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>x1 <span style="color: rgb(0, 0, 128);">==</span><span style="color: rgb(0, 0, 221);">9</span><span style="color: rgb(0, 128, 0);">)</span> fx<span style="color: rgb(0, 0, 128);">=</span><span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 128);">;</span>
                EDGE<span style="color: rgb(0, 128, 0);">[</span>x1<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">new</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">void</span> <span style="color: rgb(0, 0, 64);">*</span><span style="color: rgb(0, 128, 0);">)</span>tempedge<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span> edge<span style="color: rgb(0, 128, 0);">(</span>x1, x2, fx, EDGE<span style="color: rgb(0, 128, 0);">[</span>x1<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span> 
                EDGE<span style="color: rgb(0, 128, 0);">[</span>x2<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">new</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">void</span> <span style="color: rgb(0, 0, 64);">*</span><span style="color: rgb(0, 128, 0);">)</span>tempedge<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span> edge<span style="color: rgb(0, 128, 0);">(</span>x2, x1, <span style="color: rgb(0, 0, 221);">0</span>, EDGE<span style="color: rgb(0, 128, 0);">[</span>x2<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                EDGE<span style="color: rgb(0, 128, 0);">[</span>x1<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>target <span style="color: rgb(0, 0, 128);">=</span> EDGE<span style="color: rgb(0, 128, 0);">[</span>x2<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span> 
                EDGE<span style="color: rgb(0, 128, 0);">[</span>x2<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>target <span style="color: rgb(0, 0, 128);">=</span> EDGE<span style="color: rgb(0, 128, 0);">[</span>x1<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 128, 0);">}</span>
        <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 64);">!</span>EDGE<span style="color: rgb(0, 128, 0);">[</span>y1<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                EDGE<span style="color: rgb(0, 128, 0);">[</span>y1<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">new</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">void</span> <span style="color: rgb(0, 0, 64);">*</span><span style="color: rgb(0, 128, 0);">)</span>tempedge<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span> edge<span style="color: rgb(0, 128, 0);">(</span>y1, y2, fy, EDGE<span style="color: rgb(0, 128, 0);">[</span>y1<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span> 
                EDGE<span style="color: rgb(0, 128, 0);">[</span>y2<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">new</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">void</span> <span style="color: rgb(0, 0, 64);">*</span><span style="color: rgb(0, 128, 0);">)</span>tempedge<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span> edge<span style="color: rgb(0, 128, 0);">(</span>y2, y1, <span style="color: rgb(0, 0, 221);">0</span>, EDGE<span style="color: rgb(0, 128, 0);">[</span>y2<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                EDGE<span style="color: rgb(0, 128, 0);">[</span>y1<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>target <span style="color: rgb(0, 0, 128);">=</span> EDGE<span style="color: rgb(0, 128, 0);">[</span>y2<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span> 
                EDGE<span style="color: rgb(0, 128, 0);">[</span>y2<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>target <span style="color: rgb(0, 0, 128);">=</span> EDGE<span style="color: rgb(0, 128, 0);">[</span>y1<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 128, 0);">}</span>
        <span style="color: rgb(102, 102, 102);">//原图的边</span>
        EDGE<span style="color: rgb(0, 128, 0);">[</span>x2<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">new</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">void</span> <span style="color: rgb(0, 0, 64);">*</span><span style="color: rgb(0, 128, 0);">)</span>tempedge<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span> edge<span style="color: rgb(0, 128, 0);">(</span>x2, y1, <span style="color: rgb(0, 0, 255);">INT_MAX</span>, EDGE<span style="color: rgb(0, 128, 0);">[</span>x2<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span> 
        EDGE<span style="color: rgb(0, 128, 0);">[</span>y1<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">new</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">void</span> <span style="color: rgb(0, 0, 64);">*</span><span style="color: rgb(0, 128, 0);">)</span>tempedge<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span> edge<span style="color: rgb(0, 128, 0);">(</span>y1, x2, <span style="color: rgb(0, 0, 221);">0</span>, EDGE<span style="color: rgb(0, 128, 0);">[</span>y1<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
        EDGE<span style="color: rgb(0, 128, 0);">[</span>x2<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>target <span style="color: rgb(0, 0, 128);">=</span> EDGE<span style="color: rgb(0, 128, 0);">[</span>y1<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span> 
        EDGE<span style="color: rgb(0, 128, 0);">[</span>y1<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>target <span style="color: rgb(0, 0, 128);">=</span> EDGE<span style="color: rgb(0, 128, 0);">[</span>x2<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span>
        EDGE<span style="color: rgb(0, 128, 0);">[</span>y2<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">new</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">void</span> <span style="color: rgb(0, 0, 64);">*</span><span style="color: rgb(0, 128, 0);">)</span>tempedge<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span> edge<span style="color: rgb(0, 128, 0);">(</span>y2, x1, <span style="color: rgb(0, 0, 255);">INT_MAX</span>, EDGE<span style="color: rgb(0, 128, 0);">[</span>y2<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span> 
        EDGE<span style="color: rgb(0, 128, 0);">[</span>x1<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">new</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">void</span> <span style="color: rgb(0, 0, 64);">*</span><span style="color: rgb(0, 128, 0);">)</span>tempedge<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span> edge<span style="color: rgb(0, 128, 0);">(</span>x1, y2, <span style="color: rgb(0, 0, 221);">0</span>, EDGE<span style="color: rgb(0, 128, 0);">[</span>x1<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
        EDGE<span style="color: rgb(0, 128, 0);">[</span>y2<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>target <span style="color: rgb(0, 0, 128);">=</span> EDGE<span style="color: rgb(0, 128, 0);">[</span>x1<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span> 
        EDGE<span style="color: rgb(0, 128, 0);">[</span>x1<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>target <span style="color: rgb(0, 0, 128);">=</span> EDGE<span style="color: rgb(0, 128, 0);">[</span>x2<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;
</span><span style="color: rgb(0, 128, 0);">}</span>
 
<span style="color: rgb(0, 0, 255);">int</span> main<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
        <span style="color: rgb(0, 0, 221);">freopen</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(255, 0, 0);">&quot;telecow.in&quot;</span>, <span style="color: rgb(255, 0, 0);">&quot;r&quot;</span>, <span style="color: rgb(0, 0, 255);">stdin</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 221);">freopen</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(255, 0, 0);">&quot;telecow.out&quot;</span>, <span style="color: rgb(255, 0, 0);">&quot;w&quot;</span>, <span style="color: rgb(0, 0, 255);">stdout</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 221);">scanf</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(255, 0, 0);">&quot;%d%d%d%d&quot;</span>, <span style="color: rgb(0, 0, 64);">&amp;</span>N, <span style="color: rgb(0, 0, 64);">&amp;</span>M, <span style="color: rgb(0, 0, 64);">&amp;</span>Source, <span style="color: rgb(0, 0, 64);">&amp;</span>Sink<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 255);">while</span><span style="color: rgb(0, 128, 0);">(</span>M<span style="color: rgb(0, 0, 64);">--</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                <span style="color: rgb(0, 0, 221);">scanf</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(255, 0, 0);">&quot;%d%d&quot;</span>,<span style="color: rgb(0, 0, 64);">&amp;</span>x,<span style="color: rgb(0, 0, 64);">&amp;</span>y<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                build<span style="color: rgb(0, 128, 0);">(</span>x, y<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 128, 0);">}</span>
        <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">int</span> i <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 128);">;</span> i <span style="color: rgb(0, 0, 128);">&lt;=</span> N <span style="color: rgb(0, 0, 64);">*</span> <span style="color: rgb(0, 0, 221);">2</span><span style="color: rgb(0, 128, 128);">;</span> i<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span> <span style="color: rgb(102, 102, 102);">//复制现场</span>
                <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span>edge <span style="color: rgb(0, 0, 64);">*</span>e <span style="color: rgb(0, 0, 128);">=</span> EDGE<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span> e<span style="color: rgb(0, 128, 128);">;</span> e <span style="color: rgb(0, 0, 128);">=</span> e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>next<span style="color: rgb(0, 128, 0);">)</span>
                        anse<span style="color: rgb(0, 128, 0);">[</span>e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>x<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">[</span>e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>y<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>cap<span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 255);">while</span><span style="color: rgb(0, 128, 0);">(</span>RefreshDistLabel<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">)</span> FindMaxFlow<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 221);">printf</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(255, 0, 0);">&quot;%lld<span style="color: rgb(0, 0, 153); font-weight: bold;">\n</span>&quot;</span>, MAXF <span style="color: rgb(0, 0, 128);">=</span> totalflow<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
        <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">int</span> k <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 128);">;</span> k <span style="color: rgb(0, 0, 128);">&lt;=</span> N <span style="color: rgb(0, 0, 64);">*</span> <span style="color: rgb(0, 0, 221);">2</span><span style="color: rgb(0, 128, 128);">;</span> k<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span> <span style="color: rgb(102, 102, 102);">//恢复现场</span>
                <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span>edge <span style="color: rgb(0, 0, 64);">*</span>e <span style="color: rgb(0, 0, 128);">=</span> EDGE<span style="color: rgb(0, 128, 0);">[</span>k<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span> e<span style="color: rgb(0, 128, 128);">;</span> e <span style="color: rgb(0, 0, 128);">=</span> e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>next<span style="color: rgb(0, 128, 0);">)</span>
                        e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>cap <span style="color: rgb(0, 0, 128);">=</span> anse<span style="color: rgb(0, 128, 0);">[</span>e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>x<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">[</span>e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>y<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span>
 
        <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">int</span> i <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 128);">;</span> i <span style="color: rgb(0, 0, 128);">&lt;=</span> N<span style="color: rgb(0, 128, 128);">;</span> i<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>      <span style="color: rgb(102, 102, 102);">//枚举每一个点</span>
                <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>i <span style="color: rgb(0, 0, 128);">==</span> Sink <span style="color: rgb(0, 0, 64);">||</span> i <span style="color: rgb(0, 0, 128);">==</span> Source<span style="color: rgb(0, 128, 0);">)</span> <span style="color: rgb(0, 0, 255);">continue</span><span style="color: rgb(0, 128, 128);">;</span>
                <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span>edge <span style="color: rgb(0, 0, 64);">*</span>e <span style="color: rgb(0, 0, 128);">=</span> EDGE<span style="color: rgb(0, 128, 0);">[</span>i<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span> e<span style="color: rgb(0, 128, 128);">;</span> e <span style="color: rgb(0, 0, 128);">=</span> e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>next<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                        <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>y <span style="color: rgb(0, 0, 64);">-</span> e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>x <span style="color: rgb(0, 0, 128);">==</span> N<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                                temp <span style="color: rgb(0, 0, 128);">=</span> e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>cap<span style="color: rgb(0, 128, 128);">;</span>
                                e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>cap <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">0</span>, totalflow <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 128);">;</span>
                                <span style="color: rgb(0, 0, 255);">while</span><span style="color: rgb(0, 128, 0);">(</span>RefreshDistLabel<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">)</span> FindMaxFlow<span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                                <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>totalflow <span style="color: rgb(0, 0, 128);">==</span> MAXF <span style="color: rgb(0, 0, 64);">-</span> <span style="color: rgb(0, 0, 221);">1</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                                        anse<span style="color: rgb(0, 128, 0);">[</span>e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>x<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">[</span>e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>y<span style="color: rgb(0, 128, 0);">]</span> <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 128);">;</span>
                                        que.<span style="color: rgb(0, 119, 136);">push</span><span style="color: rgb(0, 128, 0);">(</span>i<span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                                        MAXF <span style="color: rgb(0, 0, 128);">=</span> totalflow<span style="color: rgb(0, 128, 128);">;</span>
                                        <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>MAXF <span style="color: rgb(0, 0, 128);">==</span> <span style="color: rgb(0, 0, 221);">0</span> <span style="color: rgb(0, 0, 64);">&amp;&amp;</span> que.<span style="color: rgb(0, 119, 136);">size</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                                                <span style="color: rgb(0, 0, 255);">if</span><span style="color: rgb(0, 128, 0);">(</span>que.<span style="color: rgb(0, 119, 136);">size</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                                                        <span style="color: rgb(0, 0, 221);">printf</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(255, 0, 0);">&quot;%d&quot;</span>, que.<span style="color: rgb(0, 119, 136);">front</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                                                        que.<span style="color: rgb(0, 119, 136);">pop</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                                                <span style="color: rgb(0, 128, 0);">}</span>
                                                <span style="color: rgb(0, 0, 255);">while</span><span style="color: rgb(0, 128, 0);">(</span>que.<span style="color: rgb(0, 119, 136);">size</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">{</span>
                                                        <span style="color: rgb(0, 0, 221);">printf</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(255, 0, 0);">&quot; %d&quot;</span>, que.<span style="color: rgb(0, 119, 136);">front</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                                                        que.<span style="color: rgb(0, 119, 136);">pop</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                                                <span style="color: rgb(0, 128, 0);">}</span>
                                                <span style="color: rgb(0, 0, 221);">printf</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(255, 0, 0);">&quot;<span style="color: rgb(0, 0, 153); font-weight: bold;">\n</span>&quot;</span><span style="color: rgb(0, 128, 0);">)</span><span style="color: rgb(0, 128, 128);">;</span>
                                                <span style="color: rgb(0, 0, 255);">return</span> <span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 128);">;</span>
                                        <span style="color: rgb(0, 128, 0);">}</span>
                                <span style="color: rgb(0, 128, 0);">}</span>
                                <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span><span style="color: rgb(0, 0, 255);">int</span> k <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">1</span>, tot <span style="color: rgb(0, 0, 128);">=</span> <span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 128);">;</span> k <span style="color: rgb(0, 0, 128);">&lt;=</span> N <span style="color: rgb(0, 0, 64);">*</span> <span style="color: rgb(0, 0, 221);">2</span><span style="color: rgb(0, 128, 128);">;</span> k<span style="color: rgb(0, 0, 64);">++</span><span style="color: rgb(0, 128, 0);">)</span> <span style="color: rgb(102, 102, 102);">//恢复现场</span>
                                        <span style="color: rgb(0, 0, 255);">for</span><span style="color: rgb(0, 128, 0);">(</span>edge <span style="color: rgb(0, 0, 64);">*</span>e <span style="color: rgb(0, 0, 128);">=</span> EDGE<span style="color: rgb(0, 128, 0);">[</span>k<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span> e<span style="color: rgb(0, 128, 128);">;</span> e <span style="color: rgb(0, 0, 128);">=</span> e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>next<span style="color: rgb(0, 128, 0);">)</span>
                                                e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>cap <span style="color: rgb(0, 0, 128);">=</span> anse<span style="color: rgb(0, 128, 0);">[</span>e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>x<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 0);">[</span>e<span style="color: rgb(0, 0, 64);">-</span><span style="color: rgb(0, 0, 128);">&gt;</span>y<span style="color: rgb(0, 128, 0);">]</span><span style="color: rgb(0, 128, 128);">;</span>
                        <span style="color: rgb(0, 128, 0);">}</span>
                <span style="color: rgb(0, 128, 0);">}</span>
        <span style="color: rgb(0, 128, 0);">}</span>
        <span style="color: rgb(0, 0, 255);">return</span> <span style="color: rgb(0, 0, 221);">0</span><span style="color: rgb(0, 128, 128);">;
</span><span style="color: rgb(0, 128, 0);">}</span></pre></div></div></div></div></div><div align="left" style="text-indent: 0mm; text-align: -webkit-left; margin: 4.75mm 0mm;"><font face="黑体"><font color="#010101"><span style="font-size: 13pt;"><b>[</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>注意事项</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>]</b></span></font></font></div><div align="left" style="text-indent: 0mm; text-align: -webkit-left; margin: 4.75mm 0mm;"><font color="#010101" face="宋体">c++中的memcpy是浅复制.</font></div><div align="justify"><font face="黑体"><font color="#010101"><span style="font-size: 13pt;"><b>[</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>难易等级</b></span></font><font color="#010101"><span style="font-size: 13pt;"><b>]</b></span></font></font><font color="#010101" size="2"><span style="font-size: 10pt;"><b><font face="黑体"> Medium Up(省选 the 1st)</font></b></span></font></div></div>
</div></body></html> 