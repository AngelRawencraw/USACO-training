<html>
<head>
  <title>USACO 4.4.2 milk6</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/268868 (zh-CN); Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="814"/>
<h1>USACO 4.4.2 milk6</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>解题报告</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体"><span style="font-size:12pt">求最小割方案。我的方法是：根据最大流最小割定理，满足最大流的最小割的边集一定是饱和边。那么删除一条路径，再次查找最大流，如果与先前的差值恰好为删除路径的容量，则此路径包含于最小割集合中。查找时，分为两类：一类是最小割是一条割边，这样直接按照顺序遍历即可。另一类是最小割多于一条，同样按顺序遍历，保证题目要求。我的最大流算法仍然使用人工栈的</span></font> <font color="#010101" face="Arial"><span style="font-size:12pt">Dinic.</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>运行情况</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">Compiling... <br>
Compile: OK</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">Executing...<br>
   Test 1: TEST OK [0.011 secs, 2944 KB]<br>
   Test 2: TEST OK [0.011 secs, 2944 KB]<br>
   Test 3: TEST OK [0.011 secs, 2944 KB]<br>
   Test 4: TEST OK [0.000 secs, 2944 KB]<br>
   Test 5: TEST OK [0.108 secs, 2988 KB]<br>
   Test 6: TEST OK [0.011 secs, 2952 KB]<br>
   Test 7: TEST OK [0.022 secs, 2948 KB]<br>
   Test 8: TEST OK [0.000 secs, 2948 KB]<br>
   Test 9: TEST OK [0.022 secs, 2960 KB]<br>
   Test 10: TEST OK [0.248 secs, 2988 KB]<br>
   Test 11: TEST OK [0.011 secs, 2944 KB]<br>
   Test 12: TEST OK [0.000 secs, 2944 KB]</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">All tests OK.<br></span><span style="font-size:10pt"><b>YOUR PROGRAM ('milk6') WORKED FIRST TIME!</b></span><span style="font-size:10pt"> That's fantastic<br>
-- and a rare thing. Please accept these special automated<br>
congratulations.</span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>程序清单</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#include</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&lt;cstdio&gt;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#include</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&lt;cstring&gt;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#include</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&lt;climits&gt;</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#define</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">MAXE 50</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">#define</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">MAXN 100</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">struct</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">edge{</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">x,y,cap,flow;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    edge *next,*target;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    edge(){}</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    edge(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">x,</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">y,</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">c,edge *n):x(x),y(y),cap(c),next(n),target(0){flow=cap;}</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">*</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">operator</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">new</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">(size_t,</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">*ptr){</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">ptr;}</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}*EDGE[MAXE],*Path[MAXE],*Stack[MAXE],*Lb[MAXN*11];</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">long</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">TotalFlow,N,M,Source,Sink,Dist[MAXE],Queue[MAXN]</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    ,TOTedge,rec[MAXN*11];</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">bool</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">Tedge[MAXN*11];</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">inline</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">bool</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">RefreshDistLabel(){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">long</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">head=0,tail=0,now=0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    memset(Dist,-1,</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">sizeof</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(Dist));</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    Dist[Source]=0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    Queue[++tail]=Source;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">while</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(head&lt;tail){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        now=Queue[++head];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(edge *e=EDGE[now];e;e=e-&gt;next){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(e-&gt;cap==0)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">continue</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(Dist[e-&gt;y]==-1){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                Dist[e-&gt;y]=Dist[now]+1;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                Queue[++tail]=e-&gt;y;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(e-&gt;y==Sink)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">1;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">inline</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">long</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">FindMaxFlow(){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">long</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">Lpath=1,top=Source,delta,record,Totalflow=0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    memcpy(Stack,EDGE,</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">sizeof</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(EDGE));</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">while</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(top&gt;0){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(top==Sink){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            delta=INT_MAX;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;Lpath;i++)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(delta&gt;Path[i]-&gt;cap){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                    delta=Path[i]-&gt;cap;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                    record=i;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;Lpath;i++){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                Path[i]-&gt;cap-=delta;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                Path[i]-&gt;target-&gt;cap+=delta;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            Lpath=record;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            top=Path[Lpath]-&gt;x;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            Totalflow+=delta;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">else</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            edge *temE;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(temE=Stack[top];temE;temE=temE-&gt;next){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(temE-&gt;cap==0)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">continue</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(Dist[top]+1==Dist[temE-&gt;y])</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">break</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            Stack[top]=temE;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(temE){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                Path[Lpath++]=temE;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                top=temE-&gt;y;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            }</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">else</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                Dist[top]=-1;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(Lpath==1)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">Totalflow;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                top=Path[--Lpath]-&gt;x;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">init(){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                scanf(</span></font> <font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;%ld%ld&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,&amp;N,&amp;M);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    Source=1;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    Sink=N;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    edge *tempEDGE=</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">new</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">edge[2*M];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">long</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">x,y,cap;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=M;i++){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        scanf(</span></font> <font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;%ld%ld%ld&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,&amp;x,&amp;y,&amp;cap);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        EDGE[x]=</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">new</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">((</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">*)tempEDGE++) edge(x,y,cap,EDGE[x]);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        Lb[i]=EDGE[x];</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//按照顺序映射边集</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        rec[i]=cap;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        EDGE[y]=</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">new</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">((</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">void</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">*)tempEDGE++) edge(y,x,0,EDGE[y]);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        EDGE[x]-&gt;target=EDGE[y];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        EDGE[y]-&gt;target=EDGE[x];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">while</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(RefreshDistLabel()) TotalFlow+=FindMaxFlow();</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">main()</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    freopen(</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;milk6.in&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,</span></font> <font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;r&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,stdin);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    freopen(</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;milk6.out&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,</span></font> <font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;w&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,stdout);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    init();</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">long</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">save,Flow=0,nowflow=TotalFlow;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(TotalFlow){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=M;i++){</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//查找是否存在割边</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(Lb[i]-&gt;cap&gt;TotalFlow)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">continue</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=M;j++) Lb[j]-&gt;cap=rec[j];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            save=Lb[i]-&gt;cap;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            Lb[i]-&gt;cap=Flow=0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">while</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(RefreshDistLabel()) Flow+=FindMaxFlow();</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(Flow==0) {TOTedge=1;Tedge[i]=1;</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">break</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">;}</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(!TOTedge)</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=M;i++){</span></font> <font color="#008000" face="Times New Roman" size="1"><span style="font-size:9pt">//查找最小集合</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">j=1;j&lt;=M;j++)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(!Tedge[j])Lb[j]-&gt;cap=rec[j];</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                save=Lb[i]-&gt;cap;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                Lb[i]-&gt;cap=Flow=0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">while</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(RefreshDistLabel()) Flow+=FindMaxFlow();</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(save==nowflow-Flow){</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                    nowflow-=save;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                    Tedge[i]=1;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                    TOTedge++;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">else</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">Lb[i]-&gt;cap=save;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">    printf(</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;%ld %ld\n&quot;</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">,TotalFlow,TOTedge);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">for</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(</span></font><font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">int</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">i=1;i&lt;=M;i++)</span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">if</span></font><font face="Times New Roman" size="1"><span style="font-size:9pt">(Tedge[i]) printf(</span></font><font color="#A31515" face="Times New Roman" size="1"><span style="font-size:9pt">&quot;%ld\n&quot;</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">,i);</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">                </span></font> <font color="#0000FF" face="Times New Roman" size="1"><span style="font-size:9pt">return</span></font> <font face="Times New Roman" size="1"><span style="font-size:9pt">0;</span></font></div><div align="left"><font face="Times New Roman" size="1"><span style="font-size:9pt">}</span></font></div></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>注意事项</b></span></font> <font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font></div><div align="left" style="margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:4.75mm; margin-bottom:4.75mm;"><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">无，</span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt">Netflow</span></font> <font color="#010101" face="宋体" size="2"><span style="font-size:10pt">要准（我的方法保证可以找到最小割，但不确定对于所有极端数据都能找到最小顺序方案</span></font> <font color="#010101" face="Arial" size="2"><span style="font-size:10pt">.= =||</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">）</span></font></div><div align="justify"><font color="#010101" face="Arial"><span style="font-size:13pt"><b>[</b></span></font><font color="#010101" face="宋体"><span style="font-size:13pt"><b>难易等级</b></span></font><font color="#010101" face="Arial"><span style="font-size:13pt"><b>]</b></span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt"><b> Hard down(NOI</b></span></font> <font color="#010101" face="宋体" size="2"><span style="font-size:10pt"><b>级别</b></span></font><font color="#010101" face="Arial" size="2"><span style="font-size:10pt"><b>)</b></span><span style="font-size:10pt"> //</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">如果没有相应知识，不容易想出正确的方法，限于</span></font> <font color="#010101" face="Arial" size="2"><span style="font-size:10pt">USACO</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">的数据，即使方法不完全对，也能过。</span></font></div></div>
</div></body></html> 